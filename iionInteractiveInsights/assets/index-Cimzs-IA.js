import{p as t}from"./phaser-C2RWnc_5.js";function e(t,e){const s=/Mobi|Android/i.test(navigator.userAgent),i=/iPhone/i.test(navigator.userAgent),a=window.innerWidth,n=window.innerHeight;let h,r;h=t.game.canvas.width,r=t.game.canvas.height;const o=document.getElementsByTagName("canvas")[0],l=Math.abs(parseFloat(o.style.marginTop||0))/a*h+(i?130:0),c=Math.abs(parseFloat(o.style.marginLeft||0))/n*r;let d=n/(a+2*c)*1;return console.log(s," :: isMobileDevice",d),s?{canvasWidth:h,canvasHeight:r,scaleFactor:d,topMarginOffset:l,leftMarginOffsetPercentage:c,isMobileDevice:s,isIphoneDevice:i}:(d=1.85,{canvasWidth:h,canvasHeight:r,scaleFactor:d,topMarginOffset:0,leftMarginOffsetPercentage:0})}!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver((t=>{for(const s of t)if("childList"===s.type)for(const t of s.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)})).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),"use-credentials"===t.crossOrigin?e.credentials="include":"anonymous"===t.crossOrigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();class s extends t.Scene{constructor(){super("MainMenu")}fnfetchAPI(t){fetch(t,{method:"GET"}).then((t=>console.log("Tracking sent:",t.status))).catch((t=>console.error("Tracking error:",t)))}create(){const{canvasWidth:t,canvasHeight:s,scaleFactor:i,topMarginOffset:a,leftMarginOffsetPercentage:n,isMobileDevice:h,isIphoneDevice:r}=e(this);this.canvasWidth=t,this.canvasHeight=s,this.scaleFactor=i,this.currentItemIndex=0,this.bg=this.add.image(.5*t,0*s,"city"),this.bg.setOrigin(.5,0).setDepth(150),this.bg.setScale(.4*i),this.bg.alpha=0,this.drawgraphicssky=this.add.graphics(),this.drawgraphicssky.setDepth(150),this.drawgraphicssky.fillStyle(14809063,1),this.drawgraphicssky.fillRect(0,0,t,this.bg.y+.885*this.bg.displayHeight),this.clouds=[],this.cloudSpeed=.3;for(let e=0;e<3;e++){const s=this.add.image(t*(.2+.3*e),this.bg.y+.4*this.bg.displayHeight+100*e,"clouds");s.setOrigin(.5).setDepth(200-e),s.setScale(i*(.15+.05*e)*.8),s.alpha=.6+.1*e,this.clouds.push(s)}this.buildings=this.add.image(.5*t,this.bg.y+.885*this.bg.displayHeight,"buildings"),this.buildings.setOrigin(.5,.85).setDepth(150),this.buildings.setScale(.15*i),this.buildings.alpha=1,this.drawgraphicsgrass=this.add.graphics(),this.drawgraphicsgrass.setDepth(150),this.drawgraphicsgrass.fillStyle(5934961,1),this.drawgraphicsgrass.fillRect(0,this.bg.y+.885*this.bg.displayHeight,t,s),this.road=this.add.image(.5*t,this.bg.y+.885*this.bg.displayHeight,"road"),this.road.setOrigin(.5,0).setDepth(150),this.road.setScale(.2*i),this.road.alpha=1,this.plane=this.add.image(.2*-t,.6*this.canvasHeight,"plane"),this.plane.setOrigin(.5).setDepth(150),this.plane.setScale(.1*i),this.plane.alpha=1,this.planeFlying=!1,this.nextPlaneTime=3e3,this.planeSpeedX=0,this.planeSpeedY=0,this.gridGraphics=this.add.graphics(),this.gridGraphics.setDepth(-1),this.gridTop=this.bg.y+.885*this.bg.displayHeight,this.gridBottom=s,this.gridLineColor=10040012,this.gridLineAlpha=.8,this.vanishingPointX=.5*t,this.vanishingPointY=this.gridTop,this.hLineCount=30,this.hLineSpeed=.1,this.hLineOffset=0,this.vLineCount=15,this.gridTopWidth=.15*t,this.gridBottomWidth=2*t,this.iionlogo=this.add.image(.15*t,.05*s,"iionblack"),this.iionlogo.setOrigin(.5).setDepth(160),this.iionlogo.setScale(.35*i),this.iionlogo.alpha=1,this.anims.create({key:"playerfallAnim",frames:this.anims.generateFrameNames("iionrunner",{start:0,end:3,zeroPad:3,prefix:"tile",suffix:".png"}),frameRate:24,yoyo:!0,repeat:-1}),this.anims.create({key:"playerrunAnim",frames:this.anims.generateFrameNames("iionrunner",{start:5,end:14,zeroPad:3,prefix:"tile",suffix:".png"}),frameRate:18,yoyo:!1,repeat:-1}),this.drawGrid(),this.orbs=[],this.orbSpeed=4,this.spawnY=this.gridTop,this.despawnY=.9*s,this.lanes=[.45,.5,.55],this.minOrbScale=.03*i,this.maxOrbScale=.2*i,this.laneSpread=.4,this.orbPatterns=[[0,1,2],[0,2],[0,1],[1,2]],this.currentPatternIndex=0,this.orbRowSpacing=120,this.spawnDelay=800,this.lastSpawnTime=0,this.obstacles=[],this.obstacleSpeed=4,this.minObstacleScale=.08*i,this.maxObstacleScale=.35*i,this.obstacleTypes=["ob1","ob2"],this.obstacleSpawnChance=.9,this.trees=[],this.treeSpeed=4,this.minTreeScale=.05*i,this.maxTreeScale=.35*i,this.treeSpawnDelay=1e3,this.lastTreeSpawnTime=0,this.treePositions=[{x:.25,minScale:.05,maxScale:.35},{x:.15,minScale:.05,maxScale:.25},{x:.85,minScale:.05,maxScale:.25},{x:.75,minScale:.05,maxScale:.35}],this.runnerLaneIndex=1,this.runnerLanePositions=[.15*t,.5*t,.85*t],this.slideDuration=120,this.isSliding=!1,this.coinsCollected=0,this.coinText=this.add.text(1.85*t,.05*s,"0",{fontSize:Math.round(36*i)+"px",fontFamily:"Arial",color:"#ffffff",fontStyle:"bold"}),this.coinText.setOrigin(.5).setDepth(300),this.coinIcon=this.add.image(1.925*t,.05*s,"iionorb"),this.coinIcon.setOrigin(.5).setDepth(300),this.coinIcon.setScale(.08*i),this.engagement=1,this.maxEngagement=15,this.engagementCap=14,this.engagementPerCoin=1,this.engagementPerObstacle=-.25;const o=10*i,l=.4*s,c=.92*t,d=.5*s;this.engagementBarBg=this.add.graphics(),this.engagementBarBg.lineStyle(4,16777215,1),this.engagementBarBg.fillStyle(0,.6),this.engagementBarBg.fillRoundedRect(c-o/2,d-l/2,o,l,8),this.engagementBarBg.strokeRoundedRect(c-o/2,d-l/2,o,l,8),this.engagementBarBg.setDepth(299),this.engagementBarFill=this.add.graphics(),this.engagementBarFill.setDepth(300),this.engagementOrb=this.add.image(c,d+l/2,"iionorb"),this.engagementOrb.setOrigin(.5).setDepth(301),this.engagementOrb.setScale(.06*i),this.engagementText=this.add.text(c,d-l/2-25*i,"1%",{fontSize:Math.round(20*i)+"px",fontFamily:"Poppins, sans-serif",color:"#0000ff",fontStyle:"bold"}),this.engagementText.setOrigin(.5).setDepth(302),this.barWidth=o,this.barHeight=l,this.barX=c,this.barY=d,this.runner=this.add.sprite(this.runnerLanePositions[this.runnerLaneIndex],.825*s,"iionrunner"),this.runner.setOrigin(.5).setDepth(200),this.runner.setScale(.6*i),this.runner.alpha=1,this.runner.anims.play("playerrunAnim",!0),this.swipeStartX=0,this.swipeThreshold=30,this.hasSwipedThisGesture=!1,this.input.on("pointerdown",(t=>{this.swipeStartX=t.x,this.hasSwipedThisGesture=!1})),this.input.on("pointermove",(t=>{if(!t.isDown||this.hasSwipedThisGesture)return;const e=t.x-this.swipeStartX;Math.abs(e)>=this.swipeThreshold&&(e<0&&this.runnerLaneIndex>0?(this.slideToLane(this.runnerLaneIndex-1),this.hasSwipedThisGesture=!0):e>0&&this.runnerLaneIndex<2&&(this.slideToLane(this.runnerLaneIndex+1),this.hasSwipedThisGesture=!0))})),this.input.on("pointerup",(()=>{this.hasSwipedThisGesture=!1})),this.quizQuestions=[{question:"Gaming delivers 20x higher engagement what's the biggest barrier to increasing your gaming ad spend?",options:["Budget allocation processes (gaming isn't prioritised in annual planning)","Lack of gaming audience measurement and attribution data","Concerns about brand safety and content adjacency","Limited knowledge of gaming inventory and targeting options"],type:"choice"},{question:"What's your biggest marketing priority for 2026?",options:["AI & automation adoption","Data & personalisation","Customer experience improvement","Content & creative strategy","Multi-channel integration"],type:"choice"},{question:"Participate and you could win a holiday wine bottle! ðŸ·ðŸŽ",type:"email"}],this.currentQuestionIndex=0,this.quizPopupCount=0,this.maxQuizPopups=3,this.quizInterval=5e3,this.isQuizActive=!1,this.quizElements=[],this.gamePaused=!0,this.quizTimer=this.time.addEvent({delay:this.quizInterval,callback:()=>{this.quizPopupCount<this.maxQuizPopups&&this.addpopupQuiz()},loop:!0,paused:!0}),this.sessionStartTime=Date.now(),this.userId=null,this.answers=[],this.googleScriptURL="https://script.google.com/macros/s/AKfycbwaAPBhS8rfqFL_fic2gdHAmM4bdSe6ngp2lXuw3nLqehF-DrmnjPFR3L0HsZ4VtFiazA/exec",this.createStartScreen()}createStartScreen(){this.gamePaused=!0,this.runner.setVisible(!1),this.runner.anims.pause();const t=this.canvasWidth/2,e=this.canvasHeight/2,s=this.scaleFactor;this.startScreenElements=[];const i=this.add.rectangle(t,e,this.canvasWidth,this.canvasHeight,0,.7);i.setDepth(450),this.startScreenElements.push(i);const a=this.add.image(t,e-250*s,"iionlogo");a.setOrigin(.5).setDepth(451),a.setScale(.6*s),this.startScreenElements.push(a);const n=this.add.text(t,e-150*s,"Interactive Insights",{fontSize:Math.round(42*s)+"px",fontFamily:"Poppins, sans-serif",color:"#ffffff",fontStyle:"bold"});n.setOrigin(.5).setDepth(451),this.startScreenElements.push(n);const h=this.add.text(t,e-20*s,"Collect iion coins to boost engagement.",{fontSize:Math.round(26*s)+"px",fontFamily:"Poppins, sans-serif",color:"#cccccc",align:"center",wordWrap:{width:.9*this.canvasWidth}});h.setOrigin(.5).setDepth(451),this.startScreenElements.push(h);const r=this.add.text(t,e+40*s,"Stay clear of barriers to keep your engagement strong.",{fontSize:Math.round(26*s)+"px",fontFamily:"Poppins, sans-serif",color:"#cccccc",align:"center",wordWrap:{width:.9*this.canvasWidth}});r.setOrigin(.5).setDepth(451),this.startScreenElements.push(r);const o=220*s,l=70*s,c=e+200*s,d=this.add.graphics();d.fillStyle(65535,1),d.fillRoundedRect(t-o/2,c-l/2,o,l,12),d.setDepth(451),this.startScreenElements.push(d);const g=this.add.text(t,c,"Begin â†’",{fontSize:Math.round(28*s)+"px",fontFamily:"Poppins, sans-serif",color:"#000000",fontStyle:"bold"});g.setOrigin(.5).setDepth(452),this.startScreenElements.push(g);const p=this.add.rectangle(t,c,o,l,16777215,0);p.setDepth(452).setInteractive({useHandCursor:!0}),this.startScreenElements.push(p),p.on("pointerover",(()=>{d.clear(),d.fillStyle(16777215,1),d.fillRoundedRect(t-o/2,c-l/2,o,l,12)})),p.on("pointerout",(()=>{d.clear(),d.fillStyle(65535,1),d.fillRoundedRect(t-o/2,c-l/2,o,l,12)})),p.on("pointerdown",(()=>{this.closeStartScreen()}))}closeStartScreen(){this.tweens.add({targets:this.startScreenElements,alpha:0,y:"+=20",duration:300,ease:"Power2",onComplete:()=>{this.startScreenElements.forEach((t=>t.destroy())),this.startScreenElements=[],this.startCountdown()}})}startCountdown(){this.gamePaused=!0,this.runner.setVisible(!0),this.runner.anims.pause();const t=this.canvasWidth/2,e=this.canvasHeight/2,s=Math.round(120*this.scaleFactor),i=this.add.text(t,e,"3",{fontSize:s+"px",fontFamily:"Arial",color:"#ffffff",fontStyle:"bold",stroke:"#000000",strokeThickness:6});i.setOrigin(.5).setDepth(500);const a=["3","2","1","GO!"];let n=0;const h=()=>{if(n>=a.length)return i.destroy(),void this.startGame();i.setText(a[n]),i.setScale(.5).setAlpha(0),this.tweens.add({targets:i,scale:1.2,alpha:1,duration:200,ease:"Back.out",onComplete:()=>{this.tweens.add({targets:i,scale:1.5,alpha:0,duration:300,delay:300,ease:"Power2",onComplete:()=>{n++,h()}})}})};h()}startGame(){this.gamePaused=!1,this.runner.anims.resume(),this.quizTimer.paused=!1,this.bgTween=this.tweens.add({targets:this.buildings,y:this.buildings.y-.0025*this.canvasHeight,duration:200,ease:"Cubic.easeInOut",yoyo:!0,repeat:-1}),this.spawnOrbRow(),this.lastSpawnTime=this.time.now}slideToLane(t){this.runnerLaneIndex!==t&&(this.slideTween&&this.slideTween.stop(),this.isSliding=!0,this.runnerLaneIndex=t,this.slideTween=this.tweens.add({targets:this.runner,x:this.runnerLanePositions[t],duration:this.slideDuration,ease:"Cubic.easeOut",onComplete:()=>{this.isSliding=!1}}))}spawnOrbRow(){const t=this.orbPatterns[this.currentPatternIndex];this.currentPatternIndex=(this.currentPatternIndex+1)%this.orbPatterns.length,t.forEach((t=>{const e=this.add.image(this.canvasWidth*this.lanes[t],this.spawnY,"iionorb");e.setOrigin(.5).setDepth(160),e.setScale(this.minOrbScale),e.alpha=1,e.laneIndex=t,e.startX=e.x,this.orbs.push(e)})),Math.random()<this.obstacleSpawnChance&&[0,1,2].filter((e=>!t.includes(e))).forEach((t=>{const e=this.obstacleTypes[Math.floor(Math.random()*this.obstacleTypes.length)],s=this.add.image(this.canvasWidth*this.lanes[t],this.spawnY,e);s.setOrigin(.5).setDepth(160),s.setScale(this.minObstacleScale),s.alpha=1,s.laneIndex=t,s.startX=s.x,s.isObstacle=!0,this.obstacles.push(s)}))}spawnTrees(){const t=this.treePositions.filter((t=>t.x<.5)),e=this.treePositions.filter((t=>t.x>.5)),s=[];t.length>0&&s.push(t[Math.floor(Math.random()*t.length)]),e.length>0&&s.push(e[Math.floor(Math.random()*e.length)]),s.forEach((t=>{const e=this.add.image(this.canvasWidth*t.x,this.spawnY,"trees");e.setOrigin(.5,.8).setDepth(100),e.setScale(this.scaleFactor*t.minScale),e.alpha=1,e.startX=e.x,e.xPosition=t.x,e.minScale=this.scaleFactor*t.minScale,e.maxScale=this.scaleFactor*t.maxScale,this.trees.push(e)}))}startPlaneFlight(){this.planeFlying=!0;const t=Phaser.Math.Between(.2*this.canvasHeight,.3*this.canvasHeight);this.plane.setPosition(.1*-this.canvasWidth,t);const e=Phaser.Math.Between(.1*-this.canvasHeight,t),s=1.2*this.canvasWidth,i=Math.atan2(e-t,s-this.plane.x),a=.0025*this.canvasWidth;this.planeSpeedX=Math.cos(i)*a,this.planeSpeedY=Math.sin(i)*a,this.plane.setRotation(i)}updatePlane(){this.plane.x+=this.planeSpeedX,this.plane.y+=.75*this.planeSpeedY,this.plane.x>1.22*this.canvasWidth&&(this.planeFlying=!1,this.nextPlaneTime=this.time.now+7500)}update(){if(this.gamePaused)return;const{canvasHeight:t,scaleFactor:e,minOrbScale:s,maxOrbScale:i,spawnY:a,despawnY:n,orbSpeed:h}=this;!this.planeFlying&&this.time.now>this.nextPlaneTime&&this.startPlaneFlight(),this.planeFlying&&this.updatePlane(),this.hLineOffset+=this.hLineSpeed,this.hLineOffset>=1&&(this.hLineOffset=0),this.drawGrid(),this.clouds.forEach(((t,e)=>{t.x-=this.cloudSpeed*(1+.2*e),t.x<-t.displayWidth&&(t.x=this.canvasWidth+t.displayWidth)})),this.time.now-this.lastTreeSpawnTime>=this.treeSpawnDelay&&(this.lastTreeSpawnTime=this.time.now,this.spawnTrees());for(let o=this.trees.length-1;o>=0;o--){const t=this.trees[o],e=(t.y-a)/(n-a),s=this.treeSpeed*(1+2*e);t.y+=s;const i=t.minScale+(t.maxScale-t.minScale)*e*2;t.setScale(i),t.setDepth(150+Math.floor(18*e)),t.xPosition<.5?t.x=t.startX-1.25*this.canvasWidth*e:t.x=t.startX+1.25*this.canvasWidth*e,t.y>n&&(t.destroy(),this.trees.splice(o,1))}for(let o=this.orbs.length-1;o>=0;o--){const t=this.orbs[o],e=(t.y-a)/(n-a),r=h*(1+2*e);t.y+=r;const l=s+(i-s)*e;t.setScale(l);const c=t.laneIndex-1;t.x=t.startX+c*this.laneSpread*this.canvasWidth*e,this.checkOrbCollision(t)?this.collectOrb(t,o):t.y>n&&(t.destroy(),this.orbs.splice(o,1))}const r=this.time.now;r-this.lastSpawnTime>=this.spawnDelay&&(this.lastSpawnTime=r,this.spawnOrbRow());for(let o=this.obstacles.length-1;o>=0;o--){const t=this.obstacles[o],e=(t.y-a)/(n-a),s=this.obstacleSpeed*(1+2*e);t.y+=s;const i=this.minObstacleScale+(this.maxObstacleScale-this.minObstacleScale)*e;t.setScale(i);const h=t.laneIndex-1;t.x=t.startX+h*this.laneSpread*this.canvasWidth*e,this.checkObstacleCollision(t)?this.hitObstacle(t,o):t.y>n&&(t.destroy(),this.obstacles.splice(o,1))}}checkOrbCollision(t){const e=this.runner.y,s=this.runner.x,i=60*this.scaleFactor,a=t.x-s,n=t.y-e;return Math.sqrt(a*a+n*n)<i}tweenEngagement(t){this.engagementTween&&this.engagementTween.stop(),this.engagementTween=this.tweens.add({targets:this,engagement:t,duration:500,ease:"Cubic.easeOut",onUpdate:()=>{this.updateEngagementBar()}})}updateEngagementBar(){this.engagement=Math.max(1,Math.min(this.engagementCap,this.engagement));const t=this.barHeight*(this.engagement/this.maxEngagement);this.engagementBarFill.clear(),this.engagementBarFill.fillStyle(255,.9),this.engagementBarFill.fillRoundedRect(this.barX-this.barWidth/2,this.barY+this.barHeight/2-t,this.barWidth,t,8),this.engagementOrb.y=this.barY+this.barHeight/2-t,this.engagementOrb.x=this.barX,this.engagementText.setText(`${Math.floor(this.engagement)}%`)}collectOrb(t,e){this.coinsCollected++,this.coinText.setText(this.coinsCollected.toString()),this.tweenEngagement(this.engagement+this.engagementPerCoin),this.tweens.add({targets:t,y:t.y-.5*t.displayHeight,scale:2*t.scale,alpha:0,duration:350,ease:"Power2",onComplete:()=>{t.destroy()}}),this.orbs.splice(e,1),this.tweens.add({targets:this.coinIcon,scale:.2,duration:80,yoyo:!0,ease:"Bounce"});const s=this.runner.preFX.addGlow(Math.random()<.5?16762150:16777215,4,0,!1,.1,32);this.tweens.add({targets:s,outerStrength:0,duration:600,ease:"Power2",onComplete:()=>{this.runner&&this.runner.preFX&&this.runner.preFX.remove(s)}})}checkObstacleCollision(t){const e=this.runner.y,s=this.runner.x,i=80*this.scaleFactor,a=t.x-s,n=t.y-e;return Math.sqrt(a*a+n*n)<i}hitObstacle(t,e){this.coinsCollected>0&&(this.coinsCollected=Math.max(0,this.coinsCollected-2),this.coinText.setText(this.coinsCollected.toString())),this.tweenEngagement(this.engagement+this.engagementPerObstacle),this.cameras.main.shake(200,.01);const s=this.runner.preFX.addGlow(16711680,4,0,!1,.1,32);this.tweens.add({targets:s,outerStrength:0,duration:600,ease:"Power2",onComplete:()=>{this.runner&&this.runner.preFX&&this.runner.preFX.remove(s)}}),this.tweens.add({targets:t,alpha:0,scaleX:1.5*t.scaleX,scaleY:1.5*t.scaleY,duration:200,ease:"Power2",onComplete:()=>{t.destroy()}}),this.obstacles.splice(e,1)}addpopupQuiz(){if(this.isQuizActive||this.currentQuestionIndex>=this.quizQuestions.length)return;this.isQuizActive=!0,this.gamePaused=!0,this.quizPopupCount++,this.quizElements=[],this.runner.anims.pause(),this.bgTween&&this.bgTween.pause(),this.pauseStartTime=this.time.now;const t=this.quizQuestions[this.currentQuestionIndex],e=this.canvasWidth/2,s=this.canvasHeight/2,i=this.scaleFactor;this.quizOverlay=this.add.rectangle(e,s,this.canvasWidth,this.canvasHeight,0,0),this.quizOverlay.setDepth(400),this.quizElements.push(this.quizOverlay),this.tweens.add({targets:this.quizOverlay,fillAlpha:.7,duration:250,ease:"Power2"}),this.dialog=this.add.sprite(e,s,"dialog"),this.dialog.setOrigin(.5).setDepth(401),this.dialog.setScale(0).setAlpha(0),this.quizElements.push(this.dialog),this.tweens.add({targets:this.dialog,scale:.8*i,alpha:1,duration:350,ease:"Back.easeOut"});const a=this.add.text(e,s-200*i,t.question,{fontSize:Math.round(24*i)+"px",fontFamily:"Poppins, sans-serif",color:"#ffffff",fontStyle:"bold",align:"left",wordWrap:{width:.7*this.canvasWidth,useAdvancedWrap:!0},lineSpacing:6});if(a.setOrigin(.5).setDepth(402).setAlpha(0),this.quizElements.push(a),this.tweens.add({targets:a,alpha:1,y:a.y,duration:400,delay:150,ease:"Power2"}),"choice"===t.type){const a=s-60*i,n=28*i;t.options.forEach(((t,s)=>{const h=a+s*n*3,r=.7*this.canvasWidth,o=65*i,l=12,c=this.add.graphics();c.fillStyle(16777215,1),c.fillRoundedRect(e-r/2,h-o/2,r,o,l),c.setDepth(402),c.setAlpha(0),this.quizElements.push(c);const d=this.add.rectangle(e,h,r,o,16777215,0);d.setDepth(402).setInteractive({useHandCursor:!0}),d.setAlpha(0),this.quizElements.push(d);const g=this.add.text(e,h,t,{fontSize:Math.round(18*i)+"px",fontFamily:"Poppins, sans-serif",color:"#1a365d",align:"center",wordWrap:{width:.65*this.canvasWidth,useAdvancedWrap:!0}});g.setOrigin(.5).setDepth(403).setAlpha(0),this.quizElements.push(g);const p=250+80*s;this.tweens.add({targets:[c,d,g],alpha:1,duration:300,delay:p,ease:"Power2"}),d.on("pointerover",(()=>{c.clear(),c.fillStyle(65535,1),c.fillRoundedRect(e-r/2,h-o/2,r,o,l),c.lineStyle(2,1717853,1),c.strokeRoundedRect(e-r/2,h-o/2,r,o,l)})),d.on("pointerout",(()=>{c.clear(),c.fillStyle(16777215,1),c.fillRoundedRect(e-r/2,h-o/2,r,o,l),c.lineStyle(2,1717853,1),c.strokeRoundedRect(e-r/2,h-o/2,r,o,l)})),d.on("pointerdown",(()=>{c.clear(),c.fillStyle(65535,1),c.fillRoundedRect(e-r/2,h-o/2,r,o,l),c.lineStyle(2,1717853,1),c.strokeRoundedRect(e-r/2,h-o/2,r,o,l),this.selectQuizOption(s)}))}))}else if("email"===t.type){const t=s+10*i,a=document.createElement("input");a.type="email",a.placeholder="Enter your email...",a.style.cssText=`\n        width: ${.6*this.canvasWidth}px;\n        padding: 12px;\n        font-size: ${24*i}px;\n        font-family: Poppins, sans-serif;\n        border: 2px solid #1a365d;\n        border-radius: 8px;\n        outline: none;\n        text-align: center;\n        color: #1a365d;\n      `,this.emailInput=this.add.dom(e,t,a).setDepth(403),this.emailInput.setAlpha(0),this.quizElements.push(this.emailInput);const n=200*i,h=60*i,r=t+100*i,o=12,l=this.add.graphics();l.fillStyle(16777215,1),l.fillRoundedRect(e-n/2,r-h/2,n,h,o),l.setDepth(402).setAlpha(0),this.quizElements.push(l);const c=this.add.rectangle(e,r,n,h,16777215,0);c.setDepth(402).setInteractive({useHandCursor:!0}).setAlpha(0),this.quizElements.push(c);const d=this.add.text(e,r,"Submit",{fontSize:Math.round(24*i)+"px",fontFamily:"Poppins, sans-serif",color:"#1a365d"});d.setOrigin(.5).setDepth(403).setAlpha(0),this.quizElements.push(d);const g=this.add.text(e,r+50*i,"",{fontSize:Math.round(14*i)+"px",fontFamily:"Poppins, sans-serif",color:"#ff4444",align:"center"});g.setOrigin(.5).setDepth(403),this.quizElements.push(g),this.tweens.add({targets:this.emailInput,alpha:1,duration:300,delay:250,ease:"Power2"}),this.tweens.add({targets:[l,c,d],alpha:1,duration:300,delay:350,ease:"Power2"}),c.on("pointerover",(()=>{l.clear(),l.fillStyle(65535,1),l.fillRoundedRect(e-n/2,r-h/2,n,h,o)})),c.on("pointerout",(()=>{l.clear(),l.fillStyle(16777215,1),l.fillRoundedRect(e-n/2,r-h/2,n,h,o)})),c.on("pointerdown",(()=>{const t=a.value.trim();t?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)?(console.log("Email submitted:",t),this.sendDataToGoogle({question:"Email",answer:t,type:"email"}),this.closeQuizPopup()):g.setText("Please enter a valid email address"):g.setText("Please enter your email address")}))}}selectQuizOption(t){const e=this.quizQuestions[this.currentQuestionIndex],s=e.options[t];console.log("Selected option:",t,"Answer:",s),this.sendDataToGoogle({question:e.question,answer:s,type:"choice"}),this.closeQuizPopup()}closeQuizPopup(){this.currentQuestionIndex++,this.tweens.add({targets:this.quizOverlay,fillAlpha:0,duration:300,ease:"Power2"}),this.tweens.add({targets:this.dialog,scale:0,alpha:0,duration:300,ease:"Back.easeIn"}),this.quizElements.forEach((t=>{t&&t!==this.dialog&&t!==this.quizOverlay&&this.tweens.add({targets:t,alpha:0,duration:200,ease:"Power2"})})),this.time.delayedCall(350,(()=>{this.quizElements.forEach((t=>{t&&t.destroy&&t.destroy()})),this.quizElements=[],this.isQuizActive=!1,this.gamePaused=!1,this.runner.anims.resume(),this.bgTween&&this.bgTween.resume();const t=this.time.now-this.pauseStartTime;this.lastSpawnTime+=t,this.currentQuestionIndex>=this.quizQuestions.length&&this.time.delayedCall(5e3,(()=>{this.finishGameSequence()}))}))}finishGameSequence(){this.sendDataToGoogle({action:"Game Finished",totalDuration:Math.floor((Date.now()-this.sessionStartTime)/1e3)}),this.input.enabled=!1,this.orbs.forEach((t=>{this.tweens.add({targets:t,alpha:0,duration:1e3,ease:"Power2"})})),this.tweens.add({targets:this.runner,y:this.gridTop,x:this.canvasWidth/2,scale:.2*this.runner.scale,alpha:0,duration:2500,ease:"Power2",onComplete:()=>{this.createEndScreen()}})}createEndScreen(){this.gamePaused=!0,this.runner.anims.pause(),this.bgTween&&this.bgTween.pause();const t=this.canvasWidth/2,e=this.canvasHeight/2,s=this.scaleFactor;this.endScreenElements=[];const i=this.add.rectangle(t,e,this.canvasWidth,this.canvasHeight,0,.85);i.setDepth(600),i.setAlpha(0),this.endScreenElements.push(i);const a=this.add.image(t,e-200*s,"iionlogo");a.setOrigin(.5).setDepth(601),a.setScale(.6*s),a.setAlpha(0),this.endScreenElements.push(a);const n=this.add.text(t,e-50*s,"You achieved a "+this.engagement+"% engagement score.",{fontSize:Math.round(36*s)+"px",fontFamily:"Poppins, sans-serif",color:"#ffffff",align:"center",wordWrap:{width:.9*this.canvasWidth}});n.setOrigin(.5).setDepth(601),n.setAlpha(0),this.endScreenElements.push(n);const h=this.add.text(t,e+80*s,"Thank You for Sharing Your Insights.\nWe will reach out to you soon.",{fontSize:Math.round(24*s)+"px",fontFamily:"Poppins, sans-serif",color:"#cccccc",align:"center"});h.setOrigin(.5).setDepth(601),h.setAlpha(0),this.endScreenElements.push(h),this.tweens.add({targets:this.endScreenElements,alpha:1,duration:800,ease:"Power2",stagger:200})}drawGrid(){const t=this.gridGraphics;t.clear();const e=this.gridTop,s=this.gridBottom,i=s-e,a=this.vanishingPointX,n=this.vanishingPointY,h=this.canvasWidth;t.lineStyle(2,this.gridLineColor,this.gridLineAlpha);const r=this.gridTopWidth,o=this.gridBottomWidth,l=Math.floor(this.vLineCount/2);for(let c=-l;c<=l;c++){const e=c/l,i=a+e*(r/2),h=a+e*(o/2);t.beginPath(),t.moveTo(i,n),t.lineTo(h,s),t.strokePath()}for(let c=0;c<this.hLineCount;c++){const n=(c+this.hLineOffset)/this.hLineCount,h=e+Math.pow(n,2.5)*i;if(h>e&&h<s){const s=(h-e)/i,n=r+(o-r)*s,l=a-n/2,c=a+n/2,d=.3+.7*s;t.lineStyle(1+2*s,this.gridLineColor,d),t.beginPath(),t.moveTo(l,h),t.lineTo(c,h),t.strokePath()}}t.lineStyle(3,this.gridLineColor,1),t.beginPath(),t.moveTo(0,e),t.lineTo(h,e),t.strokePath()}generateUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)}))}sendDataToGoogle(t){this.userId||(this.userId=this.generateUUID());const e={userId:this.userId,timestamp:(new Date).toISOString(),duration:Math.floor((Date.now()-this.sessionStartTime)/1e3),score:this.coinsCollected||0,...t};console.log("Sending data to Google:",e),fetch(this.googleScriptURL,{method:"POST",mode:"no-cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).catch((t=>console.error("Error sending data:",t)))}}class i extends t.Scene{constructor(){super("Preloader")}init(){const{canvasWidth:t,canvasHeight:s,scaleFactor:i,topMarginOffset:a,leftMarginOffsetPercentage:n,isMobileDevice:h,isIphoneDevice:r}=e(this);this.canvasWidth=t,this.canvasHeight=s,this.scaleFactor=i}createLoadingUI(){this.add.text(this.canvasWidth/2,this.canvasHeight/2-50*this.scaleFactor,"",{fontFamily:"FlameBold",fontSize:28*this.scaleFactor,color:"#FFFFFF",align:"center",stroke:"#E10E14",strokeThickness:5}).setOrigin(.5);const t=.6*this.canvasWidth,e=25*this.scaleFactor,s=12*this.scaleFactor;this.loadingBarContainer=this.add.graphics(),this.loadingBarContainer.lineStyle(3*this.scaleFactor,14749204,1),this.loadingBarContainer.fillStyle(3355443,1),this.loadingBarContainer.fillRoundedRect(this.canvasWidth/2-t/2,this.canvasHeight/2-e/2,t,e,s),this.loadingBarContainer.strokeRoundedRect(this.canvasWidth/2-t/2,this.canvasHeight/2-e/2,t,e,s),this.loadingBarGraphics=this.add.graphics(),this.barWidth=t,this.barHeight=e,this.borderRadius=s,this.barX=this.canvasWidth/2-t/2,this.barY=this.canvasHeight/2-e/2,this.percentText=this.add.text(this.canvasWidth/2,this.canvasHeight/2+40*this.scaleFactor,"0%",{fontFamily:"BukaBird",fontSize:22*this.scaleFactor,color:"#FFFFFF",align:"center",stroke:"#000000",strokeThickness:3}),this.percentText.setOrigin(.5)}preload(){this.add.sprite(this.canvasWidth/2,550,"iionlogo").setScale(1.3);let t=this.add.rectangle(this.canvasWidth/2,this.canvasHeight/2,560,10,13224393);t.width=590,t.alpha=.4;let e=this.add.rectangle(this.canvasWidth/2,this.canvasHeight/2,560,10,16777215);e.alpha=.8,this.load.on("progress",(t=>{e.width=590*t})),this.load.on("complete",(()=>{setTimeout((()=>{this.scene.start("MainMenu")}),250)}),this),this.load.setPath("assets"),this.load.image("city","city.png"),this.load.image("road","road2.png"),this.load.atlas("iionrunner","runner.png","runner.json"),this.load.image("iionorb","iionorb.png"),this.load.image("dialog","dialog.png"),this.load.image("buildings","buildings.png"),this.load.image("clouds","clouds.png"),this.load.image("ob1","ob1.png"),this.load.image("ob2","ob2.png"),this.load.image("trees","trees.png"),this.load.image("iionblack","iionlogoblack.png"),this.load.image("plane","plane.png")}create(){}}class a extends t.Scene{constructor(){super("Boot")}init(){const{canvasWidth:t,canvasHeight:s,scaleFactor:i,topMarginOffset:a,leftMarginOffsetPercentage:n,isMobileDevice:h,isIphoneDevice:r}=e(this);this.canvasWidth=t,this.canvasHeight=s,this.scaleFactor=i}createLoadingUI(){this.add.text(this.canvasWidth/2,this.canvasHeight/2-50*this.scaleFactor,"",{fontFamily:"FlameBold",fontSize:28*this.scaleFactor,color:"#FFFFFF",align:"center",stroke:"#E10E14",strokeThickness:5}).setOrigin(.5);const t=.6*this.canvasWidth,e=25*this.scaleFactor,s=12*this.scaleFactor;this.loadingBarContainer=this.add.graphics(),this.loadingBarContainer.lineStyle(3*this.scaleFactor,14749204,1),this.loadingBarContainer.fillStyle(3355443,1),this.loadingBarContainer.fillRoundedRect(this.canvasWidth/2-t/2,this.canvasHeight/2-e/2,t,e,s),this.loadingBarContainer.strokeRoundedRect(this.canvasWidth/2-t/2,this.canvasHeight/2-e/2,t,e,s),this.loadingBarGraphics=this.add.graphics(),this.barWidth=t,this.barHeight=e,this.borderRadius=s,this.barX=this.canvasWidth/2-t/2,this.barY=this.canvasHeight/2-e/2,this.percentText=this.add.text(this.canvasWidth/2,this.canvasHeight/2+40*this.scaleFactor,"0%",{fontFamily:"BukaBird",fontSize:22*this.scaleFactor,color:"#FFFFFF",align:"center",stroke:"#000000",strokeThickness:3}),this.percentText.setOrigin(.5)}preload(){this.load.setPath(window.trackingPath),this.load.image("iionlogo","iionlogo.png")}create(){this.scene.start("Preloader")}}let n=/Mobi|Android/i.test(navigator.userAgent);const h={type:Phaser.AUTO,parent:"game-container",width:1080,height:1920,scale:{mode:n?Phaser.Scale.ENVELOP:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH},transparent:!0,scene:[a,i,s],dom:{createContainer:!0},fps:{target:60,forceSetTimeOut:!0}};new Phaser.Game(h);
