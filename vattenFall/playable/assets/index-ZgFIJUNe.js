import{p as t}from"./phaser-C2RWnc_5.js";!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver((t=>{for(const a of t)if("childList"===a.type)for(const t of a.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)})).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),"use-credentials"===t.crossOrigin?e.credentials="include":"anonymous"===t.crossOrigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();class e extends t.Scene{constructor(){super("Boot")}preload(){this.load.image("logo",window.trackingPath+"/logo.png")}create(){this.scene.start("Preloader")}}function a(t,e){const a=/Mobi|Android/i.test(navigator.userAgent),s=/iPhone/i.test(navigator.userAgent),i=window.innerWidth,h=window.innerHeight;let n,o;n=t.game.canvas.width,o=t.game.canvas.height;const r=document.getElementsByTagName("canvas")[0],c=Math.abs(parseFloat(r.style.marginTop||0))/i*n+(s?130:0),l=Math.abs(parseFloat(r.style.marginLeft||0))/h*o;let d=h/(i+2*l)*.85;return a?{canvasWidth:n,canvasHeight:o,scaleFactor:d,topMarginOffset:c,leftMarginOffsetPercentage:l,isMobileDevice:a,isIphoneDevice:s}:(d=1.4,{canvasWidth:n,canvasHeight:o,scaleFactor:d,topMarginOffset:0,leftMarginOffsetPercentage:0})}class s extends Phaser.GameObjects.Graphics{constructor(t,{width:e=t.scale.width,height:a=160,y:s=200,stroke:i=10211839,lineWidth:h=3,step:n=2,freqPx:o=300,speed:r=.02,intensity:c=80}={}){super(t),t.add.existing(this),this.boxW=e,this.boxH=a,this.x=0,this.y=s,this.lineWidth=h,this.stroke=i,this.step=n,this.freq=2*Math.PI/o,this.speed=r,this.intensity=c,this.phase=0,this.shadowColor=16777215,this.shadowAlpha=.6,this.shadowBlur=8,window.PHASER_SINE=this}setIntensity(t){return this.intensity=Math.max(0,Number(t)||0),this}setFrequencyPixels(t){return this.freq=2*Math.PI/Math.max(1,t),this}setSpeed(t){return this.speed=t,this}preUpdate(){this.phase+=this.speed,this.renderWave()}renderWave(){const t=this.y+this.boxH/2;this.clear(),this.lineStyle(1,16777215,.08);for(let e=0;e<=this.boxW;e+=40)this.lineBetween(e,this.y,e,this.y+this.boxH);for(let e=this.y;e<=this.y+this.boxH;e+=40)this.lineBetween(0,e,this.boxW,e);this.lineStyle(1,16777215,.25);for(let e=0;e<=this.boxW;e+=12)this.lineBetween(e,t,Math.min(this.boxW,e+6),t);this.lineStyle(this.lineWidth,this.stroke,1),this.beginPath();for(let e=0;e<=this.boxW;e+=this.step){const a=t+this.intensity*Math.sin(this.freq*e+this.phase);0===e?this.moveTo(e,a):this.lineTo(e,a)}this.strokePath()}}let i=0;class h extends t.Scene{constructor(){super("MainMenu"),this.activeAppliances=[],this.harmonyText=null,this.statusText=null}fnfetchAPI(t){fetch(t,{method:"GET"}).then((t=>console.log("Tracking sent:",t.status))).catch((t=>console.error("Tracking error:",t)))}create(){this.gameStarted=!1;const{canvasWidth:t,canvasHeight:e,scaleFactor1:s,topMarginOffset:h,leftMarginOffsetPercentage:n,isMobileDevice:o,isIphoneDevice:r}=a(this);this.isGameOver=!1,this.scaleFactor=1.4,this.canvasWidth=t,this.canvasHeight=e,this.bg=this.add.image(.5*this.canvasWidth,.5*this.canvasHeight,"bgg"),this.bg.setOrigin(.5).setDepth(1),this.bg.setScale(1.2*this.scaleFactor),this.bg.alpha=1,this.tweens.add({targets:this.bg,scale:1.1*this.scaleFactor,duration:2e3,ease:"Linear",yoyo:!1,repeat:0}),this.stand=this.add.image(.55*-this.canvasWidth,.6*this.canvasHeight,"stand"),this.stand.setOrigin(.5).setDepth(2),this.stand.setScale(1.1*this.scaleFactor),this.stand.alpha=0,this.tweens.add({targets:this.stand,alpha:1,x:.55*this.canvasWidth,duration:1e3,ease:"Power2",yoyo:!1,repeat:0}),this.chairset1=this.add.image(.5*this.canvasWidth,this.stand.y+.775*this.stand.displayHeight,"chairset1"),this.chairset1.setOrigin(.5).setDepth(2),this.chairset1.setScale(.85*this.scaleFactor),this.chairset1.setAlpha(0),this.tweens.add({targets:this.chairset1,alpha:1,y:this.stand.y-.775*this.stand.displayHeight,duration:500,ease:"Power2",yoyo:!1,repeat:0}),this.chairset2=this.add.image(.5*this.canvasWidth,this.stand.y+.475*this.stand.displayHeight,"chairset2"),this.chairset2.setOrigin(.5).setDepth(2),this.chairset2.setScale(.85*this.scaleFactor),this.chairset2.setAlpha(0),this.tweens.add({targets:this.chairset2,alpha:1,y:this.stand.y-.475*this.stand.displayHeight,duration:500,delay:250,ease:"Power2",yoyo:!1,repeat:0}),this.chairset3=this.add.image(.5*this.canvasWidth,this.stand.y+.125*this.stand.displayHeight,"chairset3"),this.chairset3.setOrigin(.5).setDepth(2),this.chairset3.setScale(.85*this.scaleFactor),this.chairset3.setAlpha(0),this.tweens.add({targets:this.chairset3,alpha:1,y:this.stand.y-.125*this.stand.displayHeight,duration:500,delay:500,ease:"Power2",yoyo:!1,repeat:0}),this.chairset1.setDepth(1),this.chairset2.setDepth(3),this.chairset3.setDepth(5),this.addItems("ps5",.225*this.canvasWidth,this.stand.y-.975*this.stand.displayHeight,1.2*this.scaleFactor,0,2),this.addItems("coffeeMachine",.5*this.canvasWidth,this.stand.y-1*this.stand.displayHeight,1*this.scaleFactor,0,2),this.addItems("washingMachine",.735*this.canvasWidth,this.stand.y-.825*this.stand.displayHeight,.9*this.scaleFactor,0,2),this.addItems("electrickettle",.1*this.canvasWidth,this.stand.y-.65*this.stand.displayHeight,1.2*this.scaleFactor,0,4),this.addItems("toast",.355*this.canvasWidth,this.stand.y-.615*this.stand.displayHeight,1.5*this.scaleFactor,0,4),this.addItems("dryer",.625*this.canvasWidth,this.stand.y-.66*this.stand.displayHeight,1*this.scaleFactor,0,4),this.addItems("printer",.925*this.canvasWidth,this.stand.y-.585*this.stand.displayHeight,1*this.scaleFactor,0,4),this.addItems("standmixer",.225*this.canvasWidth,this.stand.y-.3*this.stand.displayHeight,1.2*this.scaleFactor,0,6),this.addItems("juicer",.5*this.canvasWidth,this.stand.y-.325*this.stand.displayHeight,1.4*this.scaleFactor,0,6),this.addItems("iron",.775*this.canvasWidth,this.stand.y-.275*this.stand.displayHeight,1.3*this.scaleFactor,0,6),this.addItems("robotvaccum",.05*this.canvasWidth,this.stand.y+.55*this.stand.displayHeight,.85*this.scaleFactor,0,6),this.logoTxt=this.add.text(.475*this.canvasWidth,.05*this.canvasHeight,"VATTENFALL",{fontFamily:"VattenfallHeavy",fontSize:"40px",color:"#ffffff",align:"center"}),this.logoTxt.setOrigin(.5),this.logoTxt.setDepth(100),this.logoTxt.setAlpha(1),this.logo=this.add.image(this.canvasWidth/2,.05*this.canvasHeight,"logo"),this.logo.setOrigin(.5),this.logo.setDepth(100),this.logo.setAlpha(1),this.logo.setScale(.1*this.scaleFactor),this.logo.x=this.logoTxt.x+.65*this.logoTxt.displayWidth,this.logo.y=this.logoTxt.y,this.speelText=this.add.text(this.canvasWidth/2,.15*this.canvasHeight,"Speel je \napparaten slim!",{fontFamily:"VattenfallHeavy",fontSize:"80px",color:"#ffffff",align:"center"}),this.speelText.setOrigin(.5),this.speelText.setDepth(100),this.speelText.setAlpha(1),this.metText=this.add.text(this.canvasWidth/2,.82*this.canvasHeight,"Met TijdPrijs kies je het juiste \nmoment voor harmonie",{fontFamily:"VattenfallRegular",fontSize:"40px",color:"#ffffff",align:"center"}),this.metText.setOrigin(.5),this.metText.setDepth(100),this.metText.setAlpha(1),this.startBtn=this.add.image(this.canvasWidth/2,.925*this.canvasHeight,"startbtn"),this.startBtn.setOrigin(.5),this.startBtn.setDepth(100),this.startBtn.setAlpha(1),this.startBtn.setScale(.45*this.scaleFactor),this.input.on("pointerdown",(()=>{this.input.off("pointerdown"),this.tweens.add({targets:this.speelText,y:.2*-this.canvasHeight,alpha:0,duration:500,ease:"Power2",yoyo:!1,repeat:0}),this.tweens.add({targets:this.startBtn,y:1.2*this.canvasHeight,alpha:0,duration:500,delay:250,ease:"Power2",yoyo:!1,repeat:0}),this.tweens.add({targets:this.metText,y:1.2*this.canvasHeight,alpha:0,duration:500,delay:500,ease:"Power2",yoyo:!1,repeat:0}),this.startGameEffects()})),this.tweens.add({targets:this.startBtn,scale:.5*this.scaleFactor,duration:500,ease:"Power2",yoyo:!0,repeat:-1}),this.createHarmonyStatus(),i=0,this.updateHarmonyStatus(),this.time.addEvent({delay:3e3,callback:()=>{},callbackScope:this})}addItems(t,e,a,s,i,h){const n=this.add.image(e,a,t);return n.setOrigin(.5).setDepth(h),n.setScale(s),n.setAlpha(0),n.originalX=e,n.originalY=a,n.originalScale=s,n.itemType=t,n.isActive=!1,this.activeAppliances.push(n),this.tweens.add({targets:n,alpha:1,delay:1e3+1e3*Math.random(),duration:1500,ease:"Power2",yoyo:!1,repeat:0,onComplete:()=>{n.setInteractive({useHandCursor:!0}),n.on("pointerdown",(()=>{this.handleApplianceClick(n)}))}}),n}handleApplianceClick(t){this.gameStarted&&(t.isActive=!t.isActive,this.updateHarmonyLevel(t.isActive?10:-5),t.isActive?this.activateAppliance(t):this.deactivateAppliance(t))}activateAppliance(t){this.tweens.add({targets:t,scale:1.2*t.originalScale,duration:200,yoyo:!0,repeat:1,ease:"Back.easeOut",onComplete:()=>{t.setScale(t.originalScale),this.createSparkEffects(t),1===this.activeAppliances.filter((t=>t.isActive)).length&&this.showEnergyFlowStarting(),this.connectToRandomActiveAppliance(t)}})}deactivateAppliance(t){this.tweens.add({targets:t,scale:.9*t.originalScale,duration:200,yoyo:!0,repeat:0,ease:"Back.easeIn",onComplete:()=>{if(t.setScale(t.originalScale),t.glowEffect||t.outerGlow){const e=[];t.glowEffect&&e.push(t.glowEffect),t.outerGlow&&e.push(t.outerGlow),this.tweens.add({targets:e,alpha:0,scale:"-=0.2",duration:300,ease:"Power2",onComplete:()=>{t.glowEffect&&(t.glowEffect.destroy(),t.glowEffect=null),t.outerGlow&&(t.outerGlow.destroy(),t.outerGlow=null)}})}}})}addGoldenGlowEffect(t){t.glowEffect&&t.glowEffect.destroy(),t.outerGlow&&t.outerGlow.destroy();const e=this.add.image(t.x,t.y,t.texture.key);e.setScale(1.15*t.scale),e.setAlpha(0),e.setDepth(t.depth-1),e.setTint(16766720),e.setBlendMode(Phaser.BlendModes.ADD);const a=this.add.image(t.x,t.y,t.texture.key);a.setScale(1.3*t.scale),a.setAlpha(0),a.setDepth(t.depth-2),a.setTint(16753920),a.setBlendMode(Phaser.BlendModes.ADD),t.glowEffect=e,t.outerGlow=a,this.tweens.add({targets:[e,a],alpha:{from:0,to:.7},duration:400,ease:"Power2",onComplete:()=>{this.tweens.add({targets:e,alpha:{from:.7,to:.5},scale:1.2*t.scale,duration:1200,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"}),this.tweens.add({targets:a,alpha:{from:.4,to:.2},scale:1.4*t.scale,duration:1800,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"})}})}showEnergyFlowStarting(){const t=this.add.text(this.canvasWidth/2,.3*this.canvasHeight,"Energy Flow Starting!",{fontFamily:"VattenfallHeavy",fontSize:"24px",color:"#1DAD2C",stroke:"#000000",strokeThickness:4});t.setOrigin(.5),t.setDepth(100),t.setAlpha(0),this.tweens.add({targets:t,alpha:0,duration:500,yoyo:!0,hold:1e3,repeat:0,onComplete:()=>t.destroy()})}connectToRandomActiveAppliance(t){const e=this.activeAppliances.filter((e=>e.isActive&&e!==t));if(e.length>0){const a=Phaser.Utils.Array.GetRandom(e);this.createEnergyLine(t,a)}}createEnergyLine(t,e){const a=this.add.graphics();a.setDepth(20);const s=this.getHarmonyColor(i/100),h=Phaser.Display.Color.HexStringToColor(s).color;a.lineStyle(1,h,.6),a.beginPath(),a.moveTo(t.x,t.y),a.lineTo(e.x,e.y),a.strokePath();let n=.6,o=-1;const r=this.time.addEvent({delay:50,callback:()=>{n+=.03*o,(n<=.3||n>=.6)&&(o*=-1),a.clear(),a.lineStyle(1,h,n),a.beginPath(),a.moveTo(t.x,t.y),a.lineTo(e.x,e.y),a.strokePath()},callbackScope:this,loop:!0});this.time.addEvent({delay:5e3,callback:()=>{r.remove(),a.destroy()},callbackScope:this})}createSparkEffects(t){const e=this.getApplianceEffectSettings(t.itemType);this.createSparkBurst(t,e);const a=this.add.image(t.x,t.y,t.texture.key);a.setScale(.5*t.scale),a.setAlpha(.3),a.setDepth(t.depth-1),this.tweens.add({targets:a,alpha:.5,scale:.6*t.scale,duration:4e3,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"}),e.periodicSparks&&this.time.addEvent({delay:Phaser.Math.Between(2e3,5e3),callback:()=>{t.isActive},callbackScope:this,loop:!0}),e.smokeEffect&&["toast","iron","dryer"].includes(t.itemType)&&(this.addSmokeEffect(t,e.smokeScale||.15),this.time.addEvent({delay:"toast"===t.itemType?Phaser.Math.Between(1e3,2e3):Phaser.Math.Between(2e3,4e3),callback:()=>{t.isActive&&this.addSmokeEffect(t,e.smokeScale||.15)},callbackScope:this,loop:!0}))}createSparkBurst(t,e,a=1){const s=this.getApplianceSparkNumber(t.itemType);for(let i=0;i<1;i++){const a=this.add.image(t.x,t.y,`spark${s}`);a.setScale(e.scale*Phaser.Math.FloatBetween(.6,.9)),a.setDepth(t.depth+1),a.setAlpha(.7).setOrigin(.5),a.setBlendMode(Phaser.BlendModes.ADD),this.tweens.add({targets:a,scale:1.3*a.scale,duration:Phaser.Math.Between(300,400),ease:"Sine.easeInOut",onComplete:()=>{this.tweens.add({targets:a,scale:.8*a.scale,duration:Phaser.Math.Between(200,300),yoyo:!0,repeat:Phaser.Math.Between(0,1),ease:"Sine.easeInOut",onComplete:()=>{this.tweens.add({targets:a,scale:1.2*a.scale,alpha:0,duration:300,ease:"Power2",onComplete:()=>a.destroy()})}})}});const i=this.add.circle(a.x,a.y,8,16777215,.7);i.setDepth(t.depth+1),this.tweens.add({targets:i,scale:5,alpha:0,duration:300,ease:"Power1",onComplete:()=>i.destroy()});const h=this.add.circle(a.x,a.y,5,16776960,.5);h.setDepth(t.depth+1),this.tweens.add({targets:h,scale:4,alpha:0,duration:200,ease:"Power1",onComplete:()=>h.destroy()})}if(e.smokeEffect)for(let i=0;i<e.smokeCount;i++)this.addSmokeEffect(t,e.smokeScale||.2)}getApplianceEffectSettings(t){return{sparkCount:5,scale:.2,spreadX:20,spreadY:20,moveX:30,moveY:30,minDuration:800,maxDuration:1500,glowColor:16777215,periodicSparks:!1,smokeEffect:!1,smokeCount:0,...{ps5:{sparkCount:1,glowColor:16777215,sparkTint:26367,periodicSparks:!0},coffeeMachine:{sparkCount:1,smokeEffect:!0,smokeCount:2,smokeScale:.15,glowColor:16777215},washingMachine:{sparkCount:1,spreadY:30,glowColor:16777215,periodicSparks:!0},electrickettle:{sparkCount:1,smokeEffect:!0,smokeCount:1,glowColor:16777215},toast:{sparkCount:1,smokeEffect:!0,smokeCount:2,smokeScale:.18,glowColor:16777215},dryer:{sparkCount:1,spreadY:25,smokeEffect:!0,smokeCount:2,smokeScale:.2,glowColor:16777215},printer:{sparkCount:1,glowColor:16777215},standmixer:{sparkCount:1,spreadX:25,glowColor:16777215},juicer:{sparkCount:1,glowColor:16777215},iron:{sparkCount:1,smokeEffect:!0,smokeCount:3,smokeScale:.2,glowColor:16777215},robotvaccum:{sparkCount:1,spreadX:30,glowColor:16777215}}[t]||{}}}createHarmonyStatus(){this.harmonyText=this.add.text(2*this.canvasWidth,130,"ENERGY HARMONY",{fontFamily:"Arial",fontSize:"32px",color:"#ffffff",fontWeight:"bold",stroke:"#000000",strokeThickness:4}),this.harmonyText.setOrigin(.5),this.harmonyText.setDepth(100),this.statusText=this.add.text(2*this.canvasWidth,170,"0% - Tap appliances to create harmony",{fontFamily:"Arial",fontSize:"18px",color:"#ff0000",stroke:"#000000",strokeThickness:3}),this.statusText.setOrigin(.5),this.statusText.setDepth(100),this.harmonySineWave=new s(this,{width:this.canvasWidth,height:0,x:0,y:.475*this.canvasHeight,stroke:16776960,lineWidth:4,intensity:40,freqPx:200,speed:.08,step:4}),this.harmonySineWave.setDepth(0),this.lines=this.add.image(this.canvasWidth/2,1*this.canvasHeight,"lines"),this.lines.setOrigin(.5,1),this.lines.setDepth(0).setScale(.555*this.scaleFactor).setAlpha(1),this.eharmony=this.add.image(this.canvasWidth/2,1*this.canvasHeight,"eharmony"),this.eharmony.setOrigin(.5,1),this.eharmony.setDepth(0).setScale(.555*this.scaleFactor).setAlpha(1)}updateHarmonyStatus(){if(!this.statusText||!this.harmonySineWave)return;let t,e;i<30?(t="#ff0000",e=`${i}% - Energy Chaos`):i<70?(t="#ffff00",e=`${i}% - Building Harmony`):(t="#00ff00",e=`${i}% - Energy Symphony!`),this.statusText.setText(e),this.statusText.setColor(t);const a=70-.4*i;this.harmonySineWave.setIntensity(Math.max(20,a));const s=150+2.5*i;this.harmonySineWave.setFrequencyPixels(s);const h=.1-4e-4*i;let n;this.harmonySineWave.setSpeed(Math.max(.02,h)),n=i<30?16711680:i<70?16776960:65280,this.harmonySineWave.stroke=n,this.applyCameraShakeBasedOnHarmony(),100==i&&this.celebrateFullHarmony()}applyCameraShakeBasedOnHarmony(){if(!this.gameStarted)return;const t=.008*(1-i/100)*.5,e=.5*Math.floor(2e3*(1-i/100));if(t>5e-4&&e>100){this.cameras.main.shake(e,t);const a=2e3+50*i;this.shakeTimer&&this.shakeTimer.remove(),this.shakeTimer=this.time.addEvent({delay:a,callback:()=>this.applyCameraShakeBasedOnHarmony(),callbackScope:this})}}celebrateFullHarmony(){if(console.log("Full harmony reached!"),this.shakeTimer&&(this.shakeTimer.remove(),this.shakeTimer=null),this.isGameOver=!0,this.cameras.main.flash(255,255,255,255),this.cameras.main.shake(500,.01),!this.isGameOver){const t=this.add.text(this.canvasWidth/2,.15*this.canvasHeight,"ENERGY SYMPHONY \nACHIEVED!",{fontFamily:"VattenfallHeavy",fontSize:"48px",color:"#ffffff",fontWeight:"bold",align:"center"});t.setOrigin(.5),t.setDepth(200),t.setAlpha(0),this.tweens.add({targets:t,alpha:1,scale:1.2,duration:1e3,ease:"Power2",yoyo:!0,repeat:1})}this.harmonySineWave.setIntensity(25),this.harmonySineWave.setFrequencyPixels(350),this.harmonySineWave.setSpeed(.03),this.harmonySineWave.stroke=1944876,this.harmonySineWave.lineWidth=6,this.createConfetti(),this.speelText.y=.2*-this.canvasHeight,this.speelText.setText("Breng je harmonie \nin je stroomverbruik"),this.metText.setText("Ontdek TijdPrijs: het dalurencontract \nmet vaste lage tarieven"),this.startBtn.setTexture("ctabtn"),setTimeout((()=>{this.lines.setDepth(0),this.harmonySineWave.setDepth(0),this.eharmony.setDepth(0),this.tweens.add({targets:this.speelText,y:.15*this.canvasHeight,alpha:1,duration:500,delay:3e3,ease:"Power2",yoyo:!1,repeat:0}),this.tweens.add({targets:this.startBtn,y:.925*this.canvasHeight,alpha:1,duration:500,delay:250,ease:"Power2",yoyo:!1,repeat:0}),this.tweens.add({targets:this.metText,y:.82*this.canvasHeight,alpha:1,duration:500,delay:500,ease:"Power2",yoyo:!1,repeat:0}),this.input.on("pointerdown",(()=>{window.open("https://www.vattenfall.com/nl/","_blank")}))}),500)}createEnergyWeb(){const t=this.add.graphics();t.setDepth(15);const e=this.activeAppliances.filter((t=>t.isActive));if(e.length>=2){t.lineStyle(1,1944876,.6),e.forEach(((a,s)=>{const i=Math.min(3,e.length-1);for(let h=1;h<=i;h++){const i=(s+h)%e.length;t.beginPath(),t.moveTo(a.x,a.y),t.lineTo(e[i].x,e[i].y),t.strokePath()}}));let a=.6,s=-1;this.time.addEvent({delay:50,callback:()=>{a+=.02*s,(a<=.3||a>=.6)&&(s*=-1),t.clear(),t.lineStyle(1,1944876,a),e.forEach(((a,s)=>{const i=Math.min(3,e.length-1);for(let h=1;h<=i;h++){const i=(s+h)%e.length;t.beginPath(),t.moveTo(a.x,a.y),t.lineTo(e[i].x,e[i].y),t.strokePath()}}))},callbackScope:this,loop:!0})}}startRandomFlickering(){this.activeAppliances.forEach((t=>{this.flickerAppliance(t),this.time.addEvent({delay:Phaser.Math.Between(800,3e3),callback:()=>{t.isActive||(this.addRandomChaosSparkToAppliance(t),1===Phaser.Math.Between(1,4)&&this.time.addEvent({delay:100,callback:()=>this.addRandomChaosSparkToAppliance(t),callbackScope:this}))},callbackScope:this,loop:!0})}))}addInitialChaosEffects(){this.activeAppliances.forEach((t=>{for(let e=0;e<1;e++)this.time.addEvent({delay:150*e,callback:()=>this.addRandomChaosSparkToAppliance(t),callbackScope:this});if(["coffeeMachine","electrickettle","toast","iron","dryer"].includes(t.itemType)){const e="toast"===t.itemType||"iron"===t.itemType||"dryer"===t.itemType?Phaser.Math.Between(2,3):1;for(let a=0;a<e;a++)this.time.addEvent({delay:Phaser.Math.Between(300,1e3)+200*a,callback:()=>this.addSmokeEffect(t,.15),callbackScope:this})}})),this.cameras.main.shake(300,.004),this.cameras.main.flash(0,0,0,0,!0)}addRandomChaosSparkToAppliance(t){if(t.isActive)return;const e=this.getApplianceSparkNumber(t.itemType),a=this.add.image(t.x,t.y,`spark${e}`);a.setScale(.7),a.setDepth(t.depth+1),a.setAlpha(.7),a.setBlendMode(Phaser.BlendModes.ADD),this.tweens.add({targets:a,scale:1.3*a.scale,duration:Phaser.Math.Between(300,400),ease:"Sine.easeInOut",onComplete:()=>{this.tweens.add({targets:a,scale:.8*a.scale,duration:Phaser.Math.Between(200,300),yoyo:!0,repeat:Phaser.Math.Between(0,1),ease:"Sine.easeInOut",onComplete:()=>{this.tweens.add({targets:a,scale:1.2*a.scale,alpha:0,duration:300,ease:"Power2",onComplete:()=>a.destroy()})}})}});const s=this.add.circle(a.x,a.y,8,16777215,.7);s.setDepth(t.depth+1),this.tweens.add({targets:s,scale:5,alpha:0,duration:300,ease:"Power1",onComplete:()=>s.destroy()});const i=this.add.circle(a.x,a.y,5,16776960,.5);i.setDepth(t.depth+2),this.tweens.add({targets:i,scale:4,alpha:0,duration:200,ease:"Power1",onComplete:()=>i.destroy()}),1===Phaser.Math.Between(1,10)&&this.cameras.main.shake(100,.002)}flickerAppliance(t){if(t.isActive)return;const e=Phaser.Math.Between(200,600),a=Phaser.Math.Between(500,3e3);this.tweens.add({targets:t,alpha:.4,duration:e,yoyo:!0,repeat:1,delay:a,onComplete:()=>{t.isActive||(this.flickerAppliance(t),Phaser.Math.Between(1,10)<=3&&this.addSmokeEffect(t))}});const s=t.originalX,i=t.originalY,h=Phaser.Math.Between(2,8),n=Phaser.Math.Between(100,300);this.tweens.add({targets:t,x:s+Phaser.Math.Between(-h,h),y:i+Phaser.Math.Between(-h,h),duration:n,yoyo:!0,repeat:1,delay:a,onComplete:()=>{t.x=s,t.y=i}})}addSmokeEffect(t,e=.1){const a=Phaser.Math.Between(1,2);let s=-t.height/2,i=0,h=.4,n=Phaser.Math.Between(30,60),o=Phaser.Math.Between(1e3,2e3);switch(t.itemType){case"coffeeMachine":s=.7*-t.height;break;case"electrickettle":s=.8*-t.height,h=.5,n=Phaser.Math.Between(50,80);break;case"toast":s=.6*-t.height,h=.6;break;case"iron":s=.4*-t.height,i=Phaser.Math.Between(-15,15),h=.5,o=Phaser.Math.Between(1200,2200);break;case"dryer":s=.3*-t.height,i=Phaser.Math.Between(-10,10),n=Phaser.Math.Between(60,100),h=.45}const r=this.add.image(t.x+i,t.y+s,`smoke${a}`);r.setScale(e),r.setAlpha(h),r.setDepth(t.depth+2),r.setBlendMode(Phaser.BlendModes.SCREEN),this.tweens.add({targets:r,y:r.y-n,x:r.x+Phaser.Math.Between(-15,15),scale:3*e,alpha:0,rotation:Phaser.Math.FloatBetween(-.2,.2),duration:o,ease:"Power1",onComplete:()=>r.destroy()})}showInstructions(){const t=this.add.rectangle(this.canvasWidth/2,.6*this.canvasHeight,.8*this.canvasWidth,.3*this.canvasHeight,0,.7);t.setOrigin(.5),t.setDepth(150);const e=this.add.text(this.canvasWidth/2,t.y-.35*t.height,"HOW TO PLAY",{fontFamily:"Arial",fontSize:"24px",color:"#ffffff",fontWeight:"bold",stroke:"#000000",strokeThickness:4});e.setOrigin(.5),e.setDepth(151);const a=this.add.text(this.canvasWidth/2,t.y,"1. Tap appliances to activate them\n2. Each tap adds energy harmony\n3. Using appliances at the right time creates balance\n4. Reach 100% harmony to achieve Energy Symphony!",{fontFamily:"Arial",fontSize:"18px",color:"#ffffff",align:"left",stroke:"#000000",strokeThickness:2});a.setOrigin(.5),a.setDepth(151);const s=this.add.rectangle(this.canvasWidth/2,t.y+.35*t.height,200,50,43775,1);s.setOrigin(.5),s.setDepth(151),s.setInteractive({useHandCursor:!0});const i=this.add.text(s.x,s.y,"GOT IT!",{fontFamily:"Arial",fontSize:"20px",color:"#ffffff",fontWeight:"bold"});i.setOrigin(.5),i.setDepth(152),this.tweens.add({targets:[s,i],scale:1.05,duration:800,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"}),s.on("pointerdown",(()=>{t.destroy(),e.destroy(),a.destroy(),s.destroy(),i.destroy(),this.startGameEffects()})),this.instructionsGroup=[t,e,a,s,i]}startGameEffects(){this.gameStarted=!0,this.startRandomFlickering(),this.addInitialChaosEffects(),this.applyCameraShakeBasedOnHarmony(),setTimeout((()=>{this.lines.setDepth(90),this.harmonySineWave.setDepth(100),this.eharmony.setDepth(100)}),1e3)}updateHarmonyLevel(t){console.log(t,"harmonyamount",i),i+=t,i=Math.max(0,Math.min(i,100)),this.updateHarmonyStatus(),t>0&&(i%20==0||100===i)&&this.cameras.main.shake(200,.005)}update(){}getApplianceSparkNumber(t){return{ps5:2,coffeeMachine:8,washingMachine:8,electrickettle:7,toast:7,dryer:8,printer:8,standmixer:8,juicer:8,iron:7,robotvaccum:5}[t]||1}getHarmonyColor(t){return t<.3?"#ff0000":t<.7?"#ffff00":"#00ff00"}createConfetti(){const t=[16767488,2126261,16777215];for(let e=0;e<100;e++){const e=Phaser.Math.Between(0*this.canvasWidth,1*this.canvasWidth),a=Phaser.Math.Between(0*this.canvasHeight,1*this.canvasHeight),s=t[Math.floor(Math.random()*t.length)],i=Phaser.Math.Between(5,15)*this.scaleFactor,h=Phaser.Math.Between(5,15)*this.scaleFactor,n=this.add.rectangle(e,a,i,h,s);n.setOrigin(.5),n.setDepth(20),n.rotation=Math.random()*Math.PI*2;const o=Phaser.Math.Between(-500,500)*this.scaleFactor,r=Phaser.Math.Between(-500,500)*this.scaleFactor;this.tweens.add({targets:n,x:n.x+o,y:n.y+r,scaleX:0,scaleY:0,rotation:n.rotation+(Math.random()>.5?5:-5),alpha:0,duration:5e3,ease:"Cubic.easeOut",onComplete:()=>n.destroy()})}setTimeout((()=>{this.time.delayedCall(200,(()=>this.createConfettiBurst(200,t)))}),1e3)}createConfettiBurst(t,e,a=!1){for(let s=0;s<t;s++){const t=a?.2:.1,s=a?.3:.2,i=Phaser.Math.Between(this.canvasWidth*t,this.canvasWidth*(1-t)),h=Phaser.Math.Between(.1*this.canvasHeight,this.canvasHeight*(.6+s)),n=e[Math.floor(Math.random()*e.length)],o=a?1.5:1,r=Phaser.Math.Between(4,12)*this.scaleFactor*o;let c;c=Math.random()>.3?this.add.rectangle(i,h,r,r*(Math.random()>.5?.5:2),n):this.add.circle(i,h,r/2,n),c.setOrigin(.5),c.setDepth(20),c.rotation=Math.random()*Math.PI*2;const l=a?1.5:1,d=Phaser.Math.Between(-150,150)*this.scaleFactor*l,p=Phaser.Math.Between(-50,300)*this.scaleFactor*l,g=a?Phaser.Math.Between(4e3,7e3):Phaser.Math.Between(3e3,6e3);this.tweens.add({targets:c,x:c.x+d,y:c.y+p,scaleX:{from:1,to:0},scaleY:{from:1,to:0},rotation:c.rotation+(Math.random()>.5?5:-5)*(a?2:1),alpha:{from:1,to:0},duration:g,ease:"Cubic.easeOut",onComplete:()=>c.destroy()})}}}class n extends t.Scene{constructor(){super("Preloader")}init(){const{canvasWidth:t,canvasHeight:e,scaleFactor:s,topMarginOffset:i,leftMarginOffsetPercentage:h,isMobileDevice:n,isIphoneDevice:o}=a(this);this.canvasWidth=t,this.canvasHeight=e,this.scaleFactor=s,this.loader=this.add.image(.5*this.canvasWidth,.5*this.canvasHeight,"logo"),this.loader.setOrigin(1,0).setDepth(1),this.loader.setScale(.6*this.scaleFactor),this.loader.alpha=1,this.loader.x=.5*this.canvasWidth+.5*this.loader.displayWidth,this.loader.y=.5*this.canvasHeight-.5*this.loader.displayHeight}createLoadingUI(){const t=.6*this.canvasWidth,e=25*this.scaleFactor,a=12*this.scaleFactor;this.loadingBarContainer=this.add.graphics(),this.loadingBarContainer.lineStyle(3*this.scaleFactor,14749204,1),this.loadingBarContainer.fillStyle(3355443,1),this.loadingBarContainer.fillRoundedRect(this.canvasWidth/2-t/2,this.canvasHeight/2-e/2,t,e,a),this.loadingBarContainer.strokeRoundedRect(this.canvasWidth/2-t/2,this.canvasHeight/2-e/2,t,e,a),this.loadingBarGraphics=this.add.graphics(),this.barWidth=t,this.barHeight=e,this.borderRadius=a,this.barX=this.canvasWidth/2-t/2,this.barY=this.canvasHeight/2-e/2,this.percentText=this.add.text(this.canvasWidth/2,this.canvasHeight/2+40*this.scaleFactor,"0%",{fontFamily:"BukaBird",fontSize:22*this.scaleFactor,color:"#FFFFFF",align:"center",stroke:"#000000",strokeThickness:3}),this.percentText.setOrigin(.5)}preload(){this.load.on("progress",(t=>{})),this.load.on("complete",(()=>{})),this.load.setPath(window.trackingPath),this.load.image("bgg","bgg.png"),this.load.image("stand","stand.png"),this.load.image("chairset1","chairset1.png"),this.load.image("chairset2","chairset2.png"),this.load.image("chairset3","chairset3.png"),this.load.image("coffeeMachine","coffeeMachine.png"),this.load.image("juicer","juicer.png"),this.load.image("electrickettle","electrickettle.png"),this.load.image("robotvaccum","robotvaccum.png"),this.load.image("standmixer","standMixer.png"),this.load.image("iron","iron.png"),this.load.image("washingMachine","washingMachine.png"),this.load.image("vaccum","vaccum.png"),this.load.image("toast","toast.png"),this.load.image("lamp","lamp.png"),this.load.image("ps5","ps5.png"),this.load.image("dryer","dryer.png"),this.load.image("printer","printer.png"),this.load.image("spark1","spark2.png"),this.load.image("spark2","spark2.png"),this.load.image("spark3","spark7.png"),this.load.image("spark4","spark8.png"),this.load.image("spark5","spark5.png"),this.load.image("spark6","spark8.png"),this.load.image("spark7","spark8.png"),this.load.image("spark8","spark7.png"),this.load.image("smoke1","smoke1.png"),this.load.image("smoke2","smoke2.png"),this.load.image("lines","lines.png"),this.load.image("eharmony","eeHarmony.png"),this.load.image("startbtn","startbtn.png"),this.load.image("ctabtn","ctabtn.png")}create(){this.tweens.add({targets:this.loader,alpha:0,delay:1e3,duration:500,ease:"Linear",onComplete:()=>{this.scene.start("MainMenu")}})}}class o extends t.Scene{constructor(){super("GameOver")}create(){console.log("GameOver")}}const r={type:Phaser.AUTO,width:960,height:1440,parent:"game-container",background:"transparent",scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH},fps:{target:60,forceSetTimeOut:!0},transparent:!0,scene:[e,n,h,o]};new Phaser.Game(r);
