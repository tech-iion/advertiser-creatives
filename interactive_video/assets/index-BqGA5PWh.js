import{p as t}from"./phaser-C2RWnc_5.js";function e(t,e){const i=/Mobi|Android/i.test(navigator.userAgent),s=/iPhone/i.test(navigator.userAgent),a=window.innerWidth,n=window.innerHeight;let h,o;h=t.game.canvas.width,o=t.game.canvas.height;const r=document.getElementsByTagName("canvas")[0],l=Math.abs(parseFloat(r.style.marginTop||0))/a*h+(s?130:0),d=Math.abs(parseFloat(r.style.marginLeft||0))/n*o;let c=n/(a+2*d)*1;return console.log(i," :: isMobileDevice",c),i?{canvasWidth:h,canvasHeight:o,scaleFactor:c,topMarginOffset:l,leftMarginOffsetPercentage:d,isMobileDevice:i,isIphoneDevice:s}:(c=1.85,{canvasWidth:h,canvasHeight:o,scaleFactor:c,topMarginOffset:0,leftMarginOffsetPercentage:0})}!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver((t=>{for(const i of t)if("childList"===i.type)for(const t of i.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)})).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),"use-credentials"===t.crossOrigin?e.credentials="include":"anonymous"===t.crossOrigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();class i extends t.Scene{constructor(){super("MainMenu")}fnfetchAPI(t){fetch(t,{method:"GET"}).then((t=>console.log("Tracking sent:",t.status))).catch((t=>console.error("Tracking error:",t)))}create(){const{canvasWidth:t,canvasHeight:i,scaleFactor:s,topMarginOffset:a,leftMarginOffsetPercentage:n,isMobileDevice:h,isIphoneDevice:o}=e(this);this.canvasWidth=t,this.canvasHeight=i,this.scaleFactor=s,this.currentItemIndex=0,this.bg=this.add.image(.5*t,0*i,"city"),this.bg.setOrigin(.5,0).setDepth(150),this.bg.setScale(.4*s),this.bg.alpha=0,this.videoSprite=this.add.video(.5*t,0*this.canvasHeight,"gameplay_video"),this.videoSprite.setOrigin(.5,0),this.videoSprite.setDepth(150),this.videoSprite.setScale(.5*s),this.videoSprite.setAlpha(0),this.videoSprite.setPaused(!0),this.videoSprite.setLoop(!1),this.videoPoster=this.add.image(.5*t,0*this.canvasHeight,"video_poster"),this.videoPoster.setOrigin(.5,0),this.videoPoster.setDepth(150),this.videoPoster.setScale(.5*s),this.videoPoster.setAlpha(1),this.videoSprite.on("complete",(()=>{console.log("Video playback completed - cleaning up gameplay elements"),this.cleanupGameplay()})),this.drawgraphicssky=this.add.graphics(),this.drawgraphicssky.setDepth(151),this.drawgraphicssky.fillStyle(0,1),this.drawgraphicssky.fillRect(0,this.bg.y+.625*this.bg.displayHeight,t,.125*this.canvasHeight),this.drawgraphicsgrass=this.add.graphics(),this.drawgraphicsgrass.setDepth(150),this.drawgraphicsgrass.fillStyle(12686588,1),this.drawgraphicsgrass.fillRect(0,this.bg.y+.885*this.bg.displayHeight,t,i),this.road=this.add.image(.5*t,this.bg.y+.885*this.bg.displayHeight,"road"),this.road.setOrigin(.5,0).setDepth(150),this.road.setScale(.2*s),this.road.alpha=1,this.gridGraphics=this.add.graphics(),this.gridGraphics.setDepth(-1),this.gridTop=this.bg.y+.885*this.bg.displayHeight,this.gridBottom=i,this.gridLineColor=10040012,this.gridLineAlpha=.8,this.vanishingPointX=.5*t,this.vanishingPointY=this.gridTop,this.hLineCount=30,this.hLineSpeed=.1,this.hLineOffset=0,this.vLineCount=15,this.gridTopWidth=.15*t,this.gridBottomWidth=2*t,this.iionlogo=this.add.image(.5*t,.99*i,"iionblack"),this.iionlogo.setOrigin(.5,1).setDepth(160),this.iionlogo.setScale(.25*s),this.iionlogo.alpha=1,this.drawGrid(),this.orbs=[],this.orbSpeed=4,this.spawnY=this.gridTop,this.despawnY=.9*i,this.lanes=[.45,.5,.55],this.minOrbScale=.03*s,this.maxOrbScale=.2*s,this.laneSpread=.4,this.orbPatterns=[[0,1,2],[0,2],[0,1],[1,2]],this.currentPatternIndex=0,this.orbRowSpacing=120,this.spawnDelay=800,this.lastSpawnTime=0,this.trees=[],this.treeSpeed=4,this.minTreeScale=.05*s,this.maxTreeScale=.35*s,this.treeSpawnDelay=1e3,this.lastTreeSpawnTime=0,this.treePositions=[{x:.25,minScale:.05,maxScale:.35},{x:.15,minScale:.05,maxScale:.25},{x:.85,minScale:.05,maxScale:.25},{x:.75,minScale:.05,maxScale:.35}],this.runnerLaneIndex=1,this.runnerLanePositions=[.15*t,.5*t,.85*t],this.slideDuration=120,this.isSliding=!1,this.coinsCollected=0,this.coinText=this.add.text(1.85*t,.05*i,"0",{fontSize:Math.round(36*s)+"px",fontFamily:"Arial",color:"#ffffff",fontStyle:"bold"}),this.coinText.setOrigin(.5).setDepth(300),this.coinIcon=this.add.image(1.925*t,.05*i,"iionorb"),this.coinIcon.setOrigin(.5).setDepth(300),this.coinIcon.setScale(.08*s),this.engagement=1,this.maxEngagement=15,this.engagementCap=14,this.engagementPerCoin=1;const r=10*s,l=.4*i,d=1.92*t,c=.5*i;this.engagementBarBg=this.add.graphics(),this.engagementBarBg.lineStyle(4,16777215,1),this.engagementBarBg.fillStyle(0,.6),this.engagementBarBg.fillRoundedRect(d-r/2,c-l/2,r,l,8),this.engagementBarBg.strokeRoundedRect(d-r/2,c-l/2,r,l,8),this.engagementBarBg.setDepth(299),this.engagementBarFill=this.add.graphics(),this.engagementBarFill.setDepth(300),this.engagementOrb=this.add.image(d,c+l/2,"iionorb"),this.engagementOrb.setOrigin(.5).setDepth(301),this.engagementOrb.setScale(.06*s),this.engagementText=this.add.text(d,c-l/2-25*s,"1%",{fontSize:Math.round(20*s)+"px",fontFamily:"Poppins, sans-serif",color:"#0000ff",fontStyle:"bold"}),this.engagementText.setOrigin(.5).setDepth(302),this.barWidth=r,this.barHeight=l,this.barX=d,this.barY=c,this.runner=this.add.sprite(this.runnerLanePositions[this.runnerLaneIndex],.825*i,"iionrunner"),this.runner.setOrigin(.5).setDepth(200),this.runner.setScale(.85*s),this.runner.alpha=1,this.runner.setAngle(-1),this.runnerIdleTween=this.tweens.add({targets:this.runner,scale:.9*s,duration:1800,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"}),this.runnerRotationTween=this.tweens.add({targets:this.runner,angle:1,duration:1200,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"}),this.handGuide2=this.add.image(this.runner.x,this.runner.y,"hand"),this.handGuide2.setOrigin(.25,.25).setDepth(250),this.handGuide2.setScale(.3*s),this.handGuide2.setAlpha(.8),this.swipeStartX=0,this.swipeThreshold=30,this.hasSwipedThisGesture=!1,this.isUserDragging=!1,this.hasUserInteracted=!1,this.hasUserInteracted2=!1,this.input.on("pointerdown",(t=>{this.swipeStartX=t.x,this.hasSwipedThisGesture=!1,this.isUserDragging=!0,this.hasUserInteracted||(this.hasUserInteracted=!0),this.slideTween&&this.slideTween.stop()})),this.input.on("pointermove",(t=>{if(!t.isDown)return;this.handGuide&&this.hasUserInteracted&&this.tweens.add({targets:this.handGuide,alpha:0,duration:300,ease:"Power2",onComplete:()=>{this.handGuide&&(this.handGuide.destroy(),this.handGuide=null)}});const e=.1*this.canvasWidth,i=.9*this.canvasWidth,s=Math.max(e,Math.min(i,t.x));this.runner.x=s})),this.input.on("pointerup",(()=>{this.hasSwipedThisGesture=!1,this.isUserDragging=!1;const t=this.runnerLanePositions.map(((t,e)=>({index:e,distance:Math.abs(this.runner.x-t)}))).reduce(((t,e)=>e.distance<t.distance?e:t));this.runnerLaneIndex=t.index,this.slideTween=this.tweens.add({targets:this.runner,x:this.runnerLanePositions[t.index],duration:120,ease:"Cubic.easeOut"}),this.autoSwitchTimer&&this.autoSwitchTimer.remove(),this.autoSwitchTimer=this.time.delayedCall(5e3,(()=>{this.autoSwitchEnabled&&this.autoSwitchLane()}),[],this)})),this.autoSwitchEnabled=!0,this.autoSwitchMinDelay=4e3,this.autoSwitchMaxDelay=5e3,this.autoSwitchLane=()=>{if(!this.isUserDragging&&!this.gamePaused&&this.autoSwitchEnabled){const t=[];this.runnerLaneIndex>0&&t.push(this.runnerLaneIndex-1),this.runnerLaneIndex<2&&t.push(this.runnerLaneIndex+1);const e=t[Math.floor(Math.random()*t.length)];this.slideToLane(e)}if(this.autoSwitchEnabled){const t=this.autoSwitchMinDelay+Math.random()*(this.autoSwitchMaxDelay-this.autoSwitchMinDelay);this.autoSwitchTimer=this.time.delayedCall(t,this.autoSwitchLane,[],this)}},this.time.delayedCall(2e3,this.autoSwitchLane,[],this),this.quizQuestions=[{question:"Gaming delivers 20x higher engagement what's the biggest barrier to increasing your gaming ad spend?",options:["Budget allocation processes (gaming isn't prioritised in annual planning)","Lack of gaming audience measurement and attribution data","Concerns about brand safety and content adjacency","Limited knowledge of gaming inventory and targeting options"],type:"choice"},{question:"What's your biggest marketing priority for 2026?",options:["AI & automation adoption","Data & personalisation","Customer experience improvement","Content & creative strategy","Multi-channel integration"],type:"choice"},{question:"Participate and you could win a holiday wine bottle! ðŸ·ðŸŽ",type:"email"}],this.currentQuestionIndex=0,this.quizPopupCount=0,this.maxQuizPopups=3,this.quizInterval=31e3,this.isQuizActive=!1,this.quizElements=[],this.gamePaused=!0,this.sessionStartTime=Date.now(),this.userId=null,this.answers=[],this.googleScriptURL="https://script.google.com/macros/s/AKfycbwaAPBhS8rfqFL_fic2gdHAmM4bdSe6ngp2lXuw3nLqehF-DrmnjPFR3L0HsZ4VtFiazA/exec",this.createStartScreen()}createStartScreen(){this.gamePaused=!0,this.runner.anims.pause();const t=this.canvasWidth/2,e=this.canvasHeight/2,i=this.scaleFactor;this.startScreenElements=[];const s=this.add.rectangle(t,e,this.canvasWidth,this.canvasHeight,0,.01);s.setDepth(450),this.startScreenElements.push(s),this.logo=this.add.image(t,e-150*i,"iionlogo"),this.logo.setOrigin(.5).setDepth(451),this.logo.setScale(.7*i),s.setInteractive({useHandCursor:!0}),s.on("pointerdown",(()=>{this.closeStartScreen()}))}closeStartScreen(){this.runnerIdleTween.stop(),this.runnerRotationTween.stop(),this.runnerIdleTween=null,this.runnerRotationTween=null,this.handGuide2&&this.tweens.add({targets:this.handGuide2,alpha:0,duration:300,ease:"Power2",onComplete:()=>{this.handGuide2&&(this.handGuide2.destroy(),this.handGuide2=null)}}),this.tweens.add({targets:this.runner,scale:.27*this.scaleFactor,duration:500,ease:"Power2"}),this.videoSprite&&this.videoPoster&&(this.videoSprite.play(!1),this.tweens.add({targets:this.videoSprite,alpha:1,duration:300,ease:"Linear"}),this.tweens.add({targets:this.videoPoster,alpha:0,duration:300,ease:"Linear",onComplete:()=>{this.videoPoster.destroy(),this.videoPoster=null}})),this.tweens.add({targets:this.startScreenElements,alpha:0,y:"+=20",duration:300,ease:"Power2",onComplete:()=>{this.startScreenElements.forEach((t=>t.destroy())),this.startScreenElements=[],this.handGuide=this.add.image(this.runner.x,this.runner.y,"hand"),this.handGuide.setOrigin(.25).setDepth(250),this.handGuide.setScale(.125*this.scaleFactor),this.handGuide.setAlpha(.8),this.startGame()}})}startCountdown(){this.gamePaused=!0,this.runner.setVisible(!0),this.runner.anims.pause();const t=this.canvasWidth/2,e=this.canvasHeight/2,i=Math.round(120*this.scaleFactor),s=this.add.text(t,e,"3",{fontSize:i+"px",fontFamily:"Arial",color:"#ffffff",fontStyle:"bold",stroke:"#000000",strokeThickness:6});s.setOrigin(.5).setDepth(500);const a=["3","2","1","GO!"];let n=0;const h=()=>{if(n>=a.length)return s.destroy(),void this.startGame();s.setText(a[n]),s.setScale(.5).setAlpha(0),this.tweens.add({targets:s,scale:1.2,alpha:1,duration:200,ease:"Back.out",onComplete:()=>{this.tweens.add({targets:s,scale:1.5,alpha:0,duration:300,delay:300,ease:"Power2",onComplete:()=>{n++,h()}})}})};h()}startGame(){this.gamePaused=!1,this.gameplayActive=!0,this.runner.anims.resume(),this.spawnOrbRow(),this.lastSpawnTime=this.time.now}slideToLane(t){this.runnerLaneIndex!==t&&(this.slideTween&&this.slideTween.stop(),this.isSliding=!0,this.runnerLaneIndex=t,this.slideTween=this.tweens.add({targets:this.runner,x:this.runnerLanePositions[t],duration:this.slideDuration,ease:"Cubic.easeOut",onComplete:()=>{this.isSliding=!1}}))}spawnOrbRow(){const t=this.orbPatterns[this.currentPatternIndex];this.currentPatternIndex=(this.currentPatternIndex+1)%this.orbPatterns.length,t.forEach((t=>{const e=this.add.image(this.canvasWidth*this.lanes[t],this.spawnY,"iionorb");e.setOrigin(.5).setDepth(160),e.setScale(this.minOrbScale),e.alpha=1,e.laneIndex=t,e.startX=e.x,this.orbs.push(e)}))}spawnTrees(){const t=this.treePositions.filter((t=>t.x<.5)),e=this.treePositions.filter((t=>t.x>.5)),i=[];t.length>0&&i.push(t[Math.floor(Math.random()*t.length)]),e.length>0&&i.push(e[Math.floor(Math.random()*e.length)]),i.forEach((t=>{const e=this.add.image(this.canvasWidth*t.x,this.spawnY,"trees");e.setOrigin(.5,.8).setDepth(100),e.setScale(this.scaleFactor*t.minScale),e.alpha=1,e.startX=e.x,e.xPosition=t.x,e.minScale=this.scaleFactor*t.minScale,e.maxScale=this.scaleFactor*t.maxScale,this.trees.push(e)}))}update(){if(this.gamePaused)return;this.handGuide&&(this.handGuide.x=this.runner.x,this.handGuide.y=this.runner.y);const{canvasHeight:t,scaleFactor:e,minOrbScale:i,maxOrbScale:s,spawnY:a,despawnY:n,orbSpeed:h}=this;this.hLineOffset+=this.hLineSpeed,this.hLineOffset>=1&&(this.hLineOffset=0),this.drawGrid();for(let r=this.trees.length-1;r>=0;r--){const t=this.trees[r],e=(t.y-a)/(n-a),i=this.treeSpeed*(1+2*e);t.y+=i;const s=t.minScale+(t.maxScale-t.minScale)*e*2;t.setScale(s),t.setDepth(150+Math.floor(18*e)),t.xPosition<.5?t.x=t.startX-1.25*this.canvasWidth*e:t.x=t.startX+1.25*this.canvasWidth*e,t.y>n&&(t.destroy(),this.trees.splice(r,1))}for(let r=this.orbs.length-1;r>=0;r--){const t=this.orbs[r],e=(t.y-a)/(n-a),o=h*(1+2*e);t.y+=o;const l=i+(s-i)*e;t.setScale(l);const d=t.laneIndex-1;t.x=t.startX+d*this.laneSpread*this.canvasWidth*e,this.checkOrbCollision(t)?this.collectOrb(t,r):t.y>n&&(t.destroy(),this.orbs.splice(r,1))}const o=this.time.now;o-this.lastSpawnTime>=this.spawnDelay&&this.gameplayActive&&(this.lastSpawnTime=o,this.spawnOrbRow())}checkOrbCollision(t){const e=this.runner.y,i=this.runner.x,s=60*this.scaleFactor,a=t.x-i,n=t.y-e;return Math.sqrt(a*a+n*n)<s}tweenEngagement(t){this.engagementTween&&this.engagementTween.stop(),this.engagementTween=this.tweens.add({targets:this,engagement:t,duration:500,ease:"Cubic.easeOut",onUpdate:()=>{this.updateEngagementBar()}})}updateEngagementBar(){this.engagement=Math.max(1,Math.min(this.engagementCap,this.engagement));const t=this.barHeight*(this.engagement/this.maxEngagement);this.engagementBarFill.clear(),this.engagementBarFill.fillStyle(255,.9),this.engagementBarFill.fillRoundedRect(this.barX-this.barWidth/2,this.barY+this.barHeight/2-t,this.barWidth,t,8),this.engagementOrb.y=this.barY+this.barHeight/2-t,this.engagementOrb.x=this.barX,this.engagementText.setText(`${Math.floor(this.engagement)}%`)}collectOrb(t,e){this.coinsCollected++,this.coinText.setText(this.coinsCollected.toString()),this.tweenEngagement(this.engagement+this.engagementPerCoin),this.tweens.add({targets:t,y:t.y-.5*t.displayHeight,scale:2*t.scale,alpha:0,duration:350,ease:"Power2",onComplete:()=>{t.destroy()}}),this.orbs.splice(e,1),this.tweens.add({targets:this.coinIcon,scale:.2,duration:80,yoyo:!0,ease:"Bounce"});const i=.27*this.scaleFactor;this.tweens.add({targets:this.runner,scale:1.025*i,duration:100,yoyo:!0,ease:"Cubic.easeOut"});const s=this.runner.preFX.addGlow(Math.random()<.5?16762150:16777215,4,0,!1,.1,32);this.tweens.add({targets:s,outerStrength:0,duration:600,ease:"Power2",onComplete:()=>{this.runner&&this.runner.preFX&&this.runner.preFX.remove(s)}});for(let a=0;a<3;a++){const t=this.add.graphics();t.lineStyle(3,16777215,.8),t.strokeCircle(0,0,.5*this.runner.displayWidth),t.setPosition(this.runner.x,this.runner.y),t.setDepth(199),this.tweens.add({targets:t,scaleX:3,scaleY:3,alpha:0,duration:800,delay:100*a,ease:"Power2",onComplete:()=>{t.destroy()}})}}addpopupQuiz(){if(this.isQuizActive||this.currentQuestionIndex>=this.quizQuestions.length)return;this.isQuizActive=!0,this.gamePaused=!0,this.quizPopupCount++,this.quizElements=[],this.runner.anims.pause(),this.bgTween&&this.bgTween.pause(),this.pauseStartTime=this.time.now;const t=this.quizQuestions[this.currentQuestionIndex],e=this.canvasWidth/2,i=this.canvasHeight/2,s=this.scaleFactor;this.quizOverlay=this.add.rectangle(e,i,this.canvasWidth,this.canvasHeight,0,0),this.quizOverlay.setDepth(400),this.quizElements.push(this.quizOverlay),this.tweens.add({targets:this.quizOverlay,fillAlpha:.7,duration:250,ease:"Power2"}),this.dialog=this.add.sprite(e,i,"dialog"),this.dialog.setOrigin(.5).setDepth(401),this.dialog.setScale(0).setAlpha(0),this.quizElements.push(this.dialog),this.tweens.add({targets:this.dialog,scale:.8*s,alpha:1,duration:350,ease:"Back.easeOut"});const a=this.add.text(e,i-200*s,t.question,{fontSize:Math.round(24*s)+"px",fontFamily:"Poppins, sans-serif",color:"#ffffff",fontStyle:"bold",align:"left",wordWrap:{width:.7*this.canvasWidth,useAdvancedWrap:!0},lineSpacing:6});if(a.setOrigin(.5).setDepth(402).setAlpha(0),this.quizElements.push(a),this.tweens.add({targets:a,alpha:1,y:a.y,duration:400,delay:150,ease:"Power2"}),"choice"===t.type){const a=i-60*s,n=28*s;t.options.forEach(((t,i)=>{const h=a+i*n*3,o=.7*this.canvasWidth,r=65*s,l=12,d=this.add.graphics();d.fillStyle(16777215,1),d.fillRoundedRect(e-o/2,h-r/2,o,r,l),d.setDepth(402),d.setAlpha(0),this.quizElements.push(d);const c=this.add.rectangle(e,h,o,r,16777215,0);c.setDepth(402).setInteractive({useHandCursor:!0}),c.setAlpha(0),this.quizElements.push(c);const g=this.add.text(e,h,t,{fontSize:Math.round(18*s)+"px",fontFamily:"Poppins, sans-serif",color:"#1a365d",align:"center",wordWrap:{width:.65*this.canvasWidth,useAdvancedWrap:!0}});g.setOrigin(.5).setDepth(403).setAlpha(0),this.quizElements.push(g);const p=250+80*i;this.tweens.add({targets:[d,c,g],alpha:1,duration:300,delay:p,ease:"Power2"}),c.on("pointerover",(()=>{d.clear(),d.fillStyle(65535,1),d.fillRoundedRect(e-o/2,h-r/2,o,r,l),d.lineStyle(2,1717853,1),d.strokeRoundedRect(e-o/2,h-r/2,o,r,l)})),c.on("pointerout",(()=>{d.clear(),d.fillStyle(16777215,1),d.fillRoundedRect(e-o/2,h-r/2,o,r,l),d.lineStyle(2,1717853,1),d.strokeRoundedRect(e-o/2,h-r/2,o,r,l)})),c.on("pointerdown",(()=>{d.clear(),d.fillStyle(65535,1),d.fillRoundedRect(e-o/2,h-r/2,o,r,l),d.lineStyle(2,1717853,1),d.strokeRoundedRect(e-o/2,h-r/2,o,r,l),this.selectQuizOption(i)}))}))}else if("email"===t.type){const t=i+10*s,a=document.createElement("input");a.type="email",a.placeholder="Enter your email...",a.style.cssText=`\n        width: ${.6*this.canvasWidth}px;\n        padding: 12px;\n        font-size: ${24*s}px;\n        font-family: Poppins, sans-serif;\n        border: 2px solid #1a365d;\n        border-radius: 8px;\n        outline: none;\n        text-align: center;\n        color: #1a365d;\n      `,this.emailInput=this.add.dom(e,t,a).setDepth(403),this.emailInput.setAlpha(0),this.quizElements.push(this.emailInput);const n=200*s,h=60*s,o=t+100*s,r=12,l=this.add.graphics();l.fillStyle(16777215,1),l.fillRoundedRect(e-n/2,o-h/2,n,h,r),l.setDepth(402).setAlpha(0),this.quizElements.push(l);const d=this.add.rectangle(e,o,n,h,16777215,0);d.setDepth(402).setInteractive({useHandCursor:!0}).setAlpha(0),this.quizElements.push(d);const c=this.add.text(e,o,"Submit",{fontSize:Math.round(24*s)+"px",fontFamily:"Poppins, sans-serif",color:"#1a365d"});c.setOrigin(.5).setDepth(403).setAlpha(0),this.quizElements.push(c);const g=this.add.text(e,o+50*s,"",{fontSize:Math.round(14*s)+"px",fontFamily:"Poppins, sans-serif",color:"#ff4444",align:"center"});g.setOrigin(.5).setDepth(403),this.quizElements.push(g),this.tweens.add({targets:this.emailInput,alpha:1,duration:300,delay:250,ease:"Power2"}),this.tweens.add({targets:[l,d,c],alpha:1,duration:300,delay:350,ease:"Power2"}),d.on("pointerover",(()=>{l.clear(),l.fillStyle(65535,1),l.fillRoundedRect(e-n/2,o-h/2,n,h,r)})),d.on("pointerout",(()=>{l.clear(),l.fillStyle(16777215,1),l.fillRoundedRect(e-n/2,o-h/2,n,h,r)})),d.on("pointerdown",(()=>{const t=a.value.trim();t?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)?(console.log("Email submitted:",t),this.sendDataToGoogle({question:"Email",answer:t,type:"email"}),this.closeQuizPopup()):g.setText("Please enter a valid email address"):g.setText("Please enter your email address")}))}}selectQuizOption(t){const e=this.quizQuestions[this.currentQuestionIndex],i=e.options[t];console.log("Selected option:",t,"Answer:",i),this.sendDataToGoogle({question:e.question,answer:i,type:"choice"}),this.closeQuizPopup()}closeQuizPopup(){this.currentQuestionIndex++,this.tweens.add({targets:this.quizOverlay,fillAlpha:0,duration:300,ease:"Power2"}),this.tweens.add({targets:this.dialog,scale:0,alpha:0,duration:300,ease:"Back.easeIn"}),this.quizElements.forEach((t=>{t&&t!==this.dialog&&t!==this.quizOverlay&&this.tweens.add({targets:t,alpha:0,duration:200,ease:"Power2"})})),this.time.delayedCall(350,(()=>{this.quizElements.forEach((t=>{t&&t.destroy&&t.destroy()})),this.quizElements=[],this.isQuizActive=!1,this.gamePaused=!1,this.runner.anims.resume(),this.bgTween&&this.bgTween.resume();const t=this.time.now-this.pauseStartTime;this.lastSpawnTime+=t,this.currentQuestionIndex>=this.quizQuestions.length&&this.time.delayedCall(5e3,(()=>{this.finishGameSequence()}))}))}finishGameSequence(){this.sendDataToGoogle({action:"Game Finished",totalDuration:Math.floor((Date.now()-this.sessionStartTime)/1e3)}),this.input.enabled=!1,this.orbs.forEach((t=>{this.tweens.add({targets:t,alpha:0,duration:1e3,ease:"Power2"})})),this.tweens.add({targets:this.runner,y:this.gridTop,x:this.canvasWidth/2,scale:.2*this.runner.scale,alpha:0,duration:2500,ease:"Power2",onComplete:()=>{this.createEndScreen()}})}createEndScreen(){this.gamePaused=!0,this.runner.anims.pause(),this.bgTween&&this.bgTween.pause();const t=this.canvasWidth/2,e=this.canvasHeight/2,i=this.scaleFactor;this.endScreenElements=[];const s=this.add.rectangle(t,e,this.canvasWidth,this.canvasHeight,0,.85);s.setDepth(600),s.setAlpha(0),this.endScreenElements.push(s);const a=this.add.image(t,e-200*i,"iionlogo");a.setOrigin(.5).setDepth(800),a.setScale(.6*i),a.setAlpha(0),this.endScreenElements.push(a);const n=this.add.text(t,e-50*i,"You achieved a "+this.engagement+"% engagement score.",{fontSize:Math.round(36*i)+"px",fontFamily:"Poppins, sans-serif",color:"#ffffff",align:"center",wordWrap:{width:.9*this.canvasWidth}});n.setOrigin(.5).setDepth(601),n.setAlpha(0),this.endScreenElements.push(n);const h=this.add.text(t,e+80*i,"Thank You for Sharing Your Insights.\nWe will reach out to you soon.",{fontSize:Math.round(24*i)+"px",fontFamily:"Poppins, sans-serif",color:"#cccccc",align:"center"});h.setOrigin(.5).setDepth(601),h.setAlpha(0),this.endScreenElements.push(h),this.tweens.add({targets:this.endScreenElements,alpha:1,duration:800,ease:"Power2",stagger:200})}drawGrid(){const t=this.gridGraphics;t.clear();const e=this.gridTop,i=this.gridBottom,s=i-e,a=this.vanishingPointX,n=this.vanishingPointY,h=this.canvasWidth;t.lineStyle(2,this.gridLineColor,this.gridLineAlpha);const o=this.gridTopWidth,r=this.gridBottomWidth,l=Math.floor(this.vLineCount/2);for(let d=-l;d<=l;d++){const e=d/l,s=a+e*(o/2),h=a+e*(r/2);t.beginPath(),t.moveTo(s,n),t.lineTo(h,i),t.strokePath()}for(let d=0;d<this.hLineCount;d++){const n=(d+this.hLineOffset)/this.hLineCount,h=e+Math.pow(n,2.5)*s;if(h>e&&h<i){const i=(h-e)/s,n=o+(r-o)*i,l=a-n/2,d=a+n/2,c=.3+.7*i;t.lineStyle(1+2*i,this.gridLineColor,c),t.beginPath(),t.moveTo(l,h),t.lineTo(d,h),t.strokePath()}}t.lineStyle(3,this.gridLineColor,1),t.beginPath(),t.moveTo(0,e),t.lineTo(h,e),t.strokePath()}generateUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)}))}sendDataToGoogle(t){}cleanupGameplay(){console.log("Cleaning up all gameplay elements"),this.gameplayActive=!1,this.autoSwitchTimer&&this.autoSwitchTimer.remove(),this.autoSwitchEnabled=!1,this.runnerIdleTween&&this.runnerIdleTween.stop(),this.runnerRotationTween&&this.runnerRotationTween.stop(),this.runnerGlowTween&&this.runnerGlowTween.stop();const t=[];this.runner&&t.push(this.runner),this.orbs&&this.orbs.forEach((e=>t.push(e))),this.trees&&this.trees.forEach((e=>t.push(e))),this.coinText&&t.push(this.coinText),this.coinIcon&&t.push(this.coinIcon),this.engagementBarBg&&t.push(this.engagementBarBg),this.engagementBarFill&&t.push(this.engagementBarFill),this.engagementOrb&&t.push(this.engagementOrb),this.engagementText&&t.push(this.engagementText),this.road&&t.push(this.road),this.iionlogo&&t.push(this.iionlogo),this.bg&&t.push(this.bg),this.drawgraphicssky&&t.push(this.drawgraphicssky),this.drawgraphicsgrass&&t.push(this.drawgraphicsgrass),this.gridGraphics&&t.push(this.gridGraphics),this.iionlogo&&(this.iionlogo.alpha=0,this.iionlogo.destroy()),this.logo&&(this.logo.alpha=0,this.logo.destroy()),this.tweens.add({targets:t,alpha:0,duration:800,ease:"Power2",onComplete:()=>{t.forEach((t=>{t&&t.destroy&&t.destroy()})),this.orbs=[],this.trees=[],console.log("Gameplay cleanup complete - only video remains")}}),setTimeout((()=>{this.finalCTAPage()}),400)}finalCTAPage(){console.log("Final CTA page"),this.rect=this.add.graphics(),this.rect.fillStyle(0,1),this.rect.fillRect(0,0,this.canvasWidth,this.canvasHeight),this.rect.setDepth(9999),this.finalpage=this.add.image(this.canvasWidth/2,.05*this.canvasHeight,"finalpage"),this.finalpage.setDepth(9999).setScale(.85*this.scaleFactor).setOrigin(.5,0),this.finallogo=this.add.image(this.canvasWidth/2,this.canvasHeight,"finallogo"),this.finallogo.setDepth(9999).setOrigin(.5,1).setScale(.4*this.scaleFactor),this.finalpage.alpha=0,this.tweens.add({targets:this.finalpage,alpha:1,duration:800,ease:"Power2"}),this.finallogo.alpha=0,this.finallogo.setScale(.3*this.scaleFactor),this.tweens.add({targets:this.finallogo,alpha:1,scale:.4*this.scaleFactor,duration:800,delay:300,ease:"Back.out",onComplete:()=>{console.log("Final CTA page complete")}}),this.input.on("pointerdown",(()=>{window.open("https://www.myob.com/au/products/solo","_blank")}))}}class s extends t.Scene{constructor(){super("Preloader")}init(){const{canvasWidth:t,canvasHeight:i,scaleFactor:s,topMarginOffset:a,leftMarginOffsetPercentage:n,isMobileDevice:h,isIphoneDevice:o}=e(this);this.canvasWidth=t,this.canvasHeight=i,this.scaleFactor=s}createLoadingUI(){this.add.text(this.canvasWidth/2,this.canvasHeight/2-50*this.scaleFactor,"",{fontFamily:"FlameBold",fontSize:28*this.scaleFactor,color:"#FFFFFF",align:"center",stroke:"#E10E14",strokeThickness:5}).setOrigin(.5);const t=.6*this.canvasWidth,e=25*this.scaleFactor,i=12*this.scaleFactor;this.loadingBarContainer=this.add.graphics(),this.loadingBarContainer.lineStyle(3*this.scaleFactor,14749204,1),this.loadingBarContainer.fillStyle(3355443,1),this.loadingBarContainer.fillRoundedRect(this.canvasWidth/2-t/2,this.canvasHeight/2-e/2,t,e,i),this.loadingBarContainer.strokeRoundedRect(this.canvasWidth/2-t/2,this.canvasHeight/2-e/2,t,e,i),this.loadingBarGraphics=this.add.graphics(),this.barWidth=t,this.barHeight=e,this.borderRadius=i,this.barX=this.canvasWidth/2-t/2,this.barY=this.canvasHeight/2-e/2,this.percentText=this.add.text(this.canvasWidth/2,this.canvasHeight/2+40*this.scaleFactor,"0%",{fontFamily:"BukaBird",fontSize:22*this.scaleFactor,color:"#FFFFFF",align:"center",stroke:"#000000",strokeThickness:3}),this.percentText.setOrigin(.5)}preload(){this.add.sprite(this.canvasWidth/2,.4*this.canvasHeight,"iionlogo").setScale(.8);let t=this.add.rectangle(this.canvasWidth/2,this.canvasHeight/2,560,10,13224393);t.width=590,t.alpha=.4;let e=this.add.rectangle(this.canvasWidth/2,this.canvasHeight/2,560,10,16777215);e.alpha=.8,this.load.on("progress",(t=>{e.width=590*t})),this.load.on("complete",(()=>{setTimeout((()=>{this.scene.start("MainMenu")}),250)}),this),this.load.setPath("assets"),this.load.image("city","city.png"),this.load.image("road","road2.png"),this.load.image("iionrunner","player1.png"),this.load.image("iionorb","iionorb.png"),this.load.image("dialog","dialog.png"),this.load.image("trees","trees.png"),this.load.image("iionblack","iionlogoblack.png"),this.load.image("hand","hand.png"),this.load.image("finalpage","finalpage.png"),this.load.image("finallogo","finallogo.png"),this.load.video("gameplay_video","video.mp4"),this.load.image("video_poster","videoposter.jpg")}}class a extends t.Scene{constructor(){super("Boot")}init(){const{canvasWidth:t,canvasHeight:i,scaleFactor:s,topMarginOffset:a,leftMarginOffsetPercentage:n,isMobileDevice:h,isIphoneDevice:o}=e(this);this.canvasWidth=t,this.canvasHeight=i,this.scaleFactor=s}createLoadingUI(){this.add.text(this.canvasWidth/2,this.canvasHeight/2-50*this.scaleFactor,"",{fontFamily:"FlameBold",fontSize:28*this.scaleFactor,color:"#FFFFFF",align:"center",stroke:"#E10E14",strokeThickness:5}).setOrigin(.5);const t=.6*this.canvasWidth,e=25*this.scaleFactor,i=12*this.scaleFactor;this.loadingBarContainer=this.add.graphics(),this.loadingBarContainer.lineStyle(3*this.scaleFactor,14749204,1),this.loadingBarContainer.fillStyle(3355443,1),this.loadingBarContainer.fillRoundedRect(this.canvasWidth/2-t/2,this.canvasHeight/2-e/2,t,e,i),this.loadingBarContainer.strokeRoundedRect(this.canvasWidth/2-t/2,this.canvasHeight/2-e/2,t,e,i),this.loadingBarGraphics=this.add.graphics(),this.barWidth=t,this.barHeight=e,this.borderRadius=i,this.barX=this.canvasWidth/2-t/2,this.barY=this.canvasHeight/2-e/2,this.percentText=this.add.text(this.canvasWidth/2,this.canvasHeight/2+40*this.scaleFactor,"0%",{fontFamily:"BukaBird",fontSize:22*this.scaleFactor,color:"#FFFFFF",align:"center",stroke:"#000000",strokeThickness:3}),this.percentText.setOrigin(.5)}preload(){this.load.setPath(window.trackingPath),this.load.image("iionlogo","iionlogo.png")}create(){this.scene.start("Preloader")}}let n=/Mobi|Android/i.test(navigator.userAgent);const h={type:Phaser.AUTO,parent:"game-container",width:1080,height:1920,scale:{mode:n?Phaser.Scale.ENVELOP:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH},transparent:!0,scene:[a,s,i],dom:{createContainer:!0},fps:{target:60,forceSetTimeOut:!0}};new Phaser.Game(h);
